<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talks Tools - Advanced Content Suite</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        /* --- Custom Theme & Styles --- */
        :root {
            --bg-primary: #0D0D0D;
            --bg-secondary: #1A1A1A;
            --bg-tertiary: #2A2A2A;
            --accent-primary: #00FFA3;
            --accent-hover: #00E692;
            --text-primary: #FFFFFF;
            --text-secondary: #A3A3A3;
            --border-color: #2A2A2A;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }
        
        /* Custom scrollbar for the entire page */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--accent-primary); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-hover); }

        /* Professional scrollbar for the sidebar navigation */
        #main-nav::-webkit-scrollbar {
            width: 6px;
        }
        #main-nav::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }
        #main-nav::-webkit-scrollbar-thumb {
            background: var(--bg-tertiary);
            border-radius: 10px;
        }
        #main-nav::-webkit-scrollbar-thumb:hover {
            background: var(--accent-primary);
        }


        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }

        @keyframes blink {
            50% { border-color: transparent; }
        }
        .blinking-cursor {
            border-right: 3px solid var(--accent-primary);
            animation: blink 0.75s step-end infinite;
        }

        /* --- Component Styles --- */
        .sidebar-icon {
            transition: color 0.2s ease-in-out;
        }
        .sidebar-link:hover .sidebar-icon,
        .sidebar-link.active .sidebar-icon,
        .sidebar-link:hover span,
        .sidebar-link.active span {
            color: var(--accent-primary);
        }

        .main-btn {
            background-color: var(--accent-primary);
            color: var(--bg-primary);
            font-weight: 700;
            border-radius: 8px;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease;
        }
        .main-btn:hover {
            background-color: var(--accent-hover);
            transform: translateY(-2px);
        }
        .main-btn:disabled {
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
        }

        .secondary-btn {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            font-weight: 600;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: background-color 0.2s ease-in-out, transform 0.2s ease;
        }
        .secondary-btn:hover {
            background-color: #3a3a3a;
        }

        .custom-input, .custom-select, textarea {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            padding: 0.75rem 1rem;
        }
        .custom-input:focus, .custom-select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(0, 255, 163, 0.3);
        }

        .result-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        
        .result-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        /* Hide number input arrows */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        
        /* Social Media Icon Hover Effects */
        .social-link.youtube:hover { color: #FF0000; }
        .social-link.facebook:hover { color: #1877F2; }
        .social-link.whatsapp:hover { color: #25D366; }
        
        /* Header Nav Link Hover */
        .header-nav-link {
            position: relative;
        }
        .header-nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 50%;
            background-color: var(--accent-primary);
            transition: width 0.3s ease, left 0.3s ease;
        }
        .header-nav-link:hover::after {
            width: 100%;
            left: 0;
        }

    </style>
</head>
<body class="">

    <!-- Maintenance Mode Overlay - Updated UI -->
    <div id="maintenance-overlay" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] hidden flex-col items-center justify-center text-center p-8">
        <div class="result-card p-8 max-w-lg w-full">
            <i class="fas fa-wrench fa-3x text-accent-primary mb-4"></i>
            <h1 class="text-3xl font-bold text-white mb-2">Website Under Maintenance</h1>
            <p class="text-text-secondary text-lg mb-6">Our AI services are temporarily unavailable due to high demand. We are working to add more capacity.</p>
            <div class="bg-tertiary p-4 rounded-lg">
                <h2 class="text-xl font-bold text-accent-primary mb-2">Support Us</h2>
                <p class="text-text-secondary mb-4">You can help us add more generation capacity by supporting the project. Your contribution allows us to offer more free services.</p>
                <a href="https://forms.gle/WjcGZZyso8q5P6sG7" target="_blank" id="support-us-btn" class="main-btn py-2 px-6 inline-block">Support Us</a>
            </div>
        </div>
    </div>

    <!-- Main Header -->
    <header class="w-full bg-zinc-900/80 backdrop-blur-md border-b border-border-color z-40 flex-shrink-0">
        <div class="container mx-auto flex justify-between items-center p-4">
            <a href="#" data-page="home" class="nav-trigger flex items-center gap-2">
                <i class="fas fa-bolt fa-lg text-accent-primary"></i>
                <h1 class="text-xl font-bold">Talks Tools</h1>
            </a>
            <nav class="hidden md:flex items-center gap-6">
                 <a href="#" data-page="home" class="nav-trigger header-nav-link text-text-secondary hover:text-text-primary transition-colors">Home</a>
                 <a href="#" class="coming-soon-link header-nav-link text-text-secondary hover:text-text-primary transition-colors">Privacy</a>
                 <a href="#" class="coming-soon-link header-nav-link text-text-secondary hover:text-text-primary transition-colors">Contact</a>
                 <a href="#" class="coming-soon-link header-nav-link text-text-secondary hover:text-text-primary transition-colors">Services</a>
                 <a href="#" class="coming-soon-link header-nav-link text-text-secondary hover:text-text-primary transition-colors">About</a>
                 <a href="#" class="coming-soon-link header-nav-link text-text-secondary hover:text-text-primary transition-colors">Blog</a>
            </nav>
            <div class="flex items-center gap-4">
                <button id="hamburger-btn" class="p-2 text-2xl md:hidden">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="fixed top-0 left-0 w-64 h-full bg-zinc-900 border-r border-border-color p-4 flex-col justify-between transform -translate-x-full md:relative md:translate-x-0 transition-transform duration-300 ease-in-out z-50 md:flex">
            <div class="flex flex-col h-full">
                <a href="#" data-page="home" id="nav-home" class="nav-trigger hidden md:flex items-center gap-3 mb-10 px-2">
                    <i class="fas fa-bolt fa-2x text-accent-primary"></i>
                    <h1 class="text-2xl font-bold">Talks Tools</h1>
                </a>
                <nav id="main-nav" class="flex flex-col gap-1 overflow-y-auto pr-2">
                    <!-- Nav links will be injected here -->
                </nav>
            </div>
             <div class="mt-auto px-2 pt-4 flex-shrink-0">
                <p class="text-xs text-text-secondary">Powered by The Talks Automation</p>
            </div>
        </aside>

        <!-- Overlay for mobile menu -->
        <div id="overlay" class="fixed inset-0 bg-zinc-900/90 backdrop-blur-sm z-40 hidden md:hidden"></div>

        <!-- Main Content Area -->
        <div id="main-content" class="flex-1 overflow-y-auto">
            <!-- All pages will be injected here and toggled -->
            <main id="page-home" class="p-4 sm:p-6 md:p-8"></main>
            <main id="page-content-generator" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-script-generator" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-script-rewriter" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-prompt-generator" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-channel-extractor" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-tags-generator" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-keyword-suggester" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-thumbnail-downloader" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-find-competitors" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-subscribe-link" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-money-calculator" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-title-capitalizer" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-embed-code" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-image-compressor" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-background-remover" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-thumbnail-maker" class="p-4 sm:p-6 md:p-8 hidden"></main>
            <main id="page-image-generation" class="p-4 sm:p-6 md:p-8 hidden"></main>
        </div>
    </div>

    <footer class="w-full bg-zinc-900 border-t border-border-color z-40 flex-shrink-0">
        <div class="container mx-auto text-center p-4">
            <div class="flex justify-center gap-6 mb-2">
                <a href="https://youtube.com/@themustafatalks" target="_blank" class="social-link youtube text-text-secondary hover:text-accent-primary transition-colors"><i class="fab fa-youtube fa-lg"></i></a>
                <a href="https://www.facebook.com/mustafatalks/" target="_blank" class="social-link facebook text-text-secondary hover:text-accent-primary transition-colors"><i class="fab fa-facebook fa-lg"></i></a>
                <a href="https://tinyurl.com/mustafatalks" target="_blank" class="social-link whatsapp text-text-secondary hover:text-accent-primary transition-colors"><i class="fab fa-whatsapp fa-lg"></i></a>
            </div>
            <p class="text-sm text-gray-400">Powered by <span class="font-bold text-gray-300">The Talks Automation</span></p>
        </div>
    </footer>


    <!-- Generic Pop-Up -->
    <div id="popup" class="fixed bottom-5 right-5 text-white p-4 rounded-xl shadow-2xl z-50 transition-all duration-300 transform translate-y-20 opacity-0">
        <p id="popup-text" class="font-semibold"></p>
    </div>
    
    <!-- Scroll to Top Button -->
    <button id="scroll-to-top-btn" class="fixed bottom-5 left-5 bg-accent-primary text-bg-primary w-12 h-12 rounded-full shadow-lg hidden justify-center items-center text-2xl transition-opacity duration-300 z-50">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        // --- API Configuration ---
        const DEEPSEEK_API_KEY = "sk-4f1sciTMhm6DBl1OMHGmQCPuTxFDOc8Flarsdz6BeLI";
        const OPENAI_API_KEY = "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";
        const REMOVE_BG_API_KEY = "2a2b9eqtBcEHaMizCBQmMXzT";

        // --- Maintenance Mode ---
        // Set to 'true' to enable maintenance mode, 'false' to disable.
        const isMaintenanceMode = true;

        // --- Tool Definitions ---
        const tools = [
            { id: 'content-generator', name: 'Content Generator', icon: 'fas fa-magic', description: 'Instantly create SEO-optimized titles, descriptions, and tags.' },
            { id: 'script-generator', name: 'Script Generator', icon: 'fas fa-file-alt', description: 'Generate complete video scripts in any language or tone.' },
            { id: 'script-rewriter', name: 'Script Rewriter', icon: 'fas fa-feather-alt', description: 'Rewrite your script or get a better version of any YouTube video\'s script.' },
            { id: 'prompt-generator', name: 'Prompt Generator', icon: 'fas fa-lightbulb', description: 'Craft expert-level prompts for AI image, video, and text generation.' },
            { id: 'thumbnail-maker', name: 'Thumbnail Maker', icon: 'fas fa-wand-magic-sparkles', description: 'Create stunning thumbnails from a prompt or get inspired by a YouTube video.' },
            { id: 'image-generation', name: 'Image Generation', icon: 'fas fa-palette', description: 'Generate high-quality images from text or other images in any aspect ratio.' },
            { id: 'image-compressor', name: 'Image Compressor', icon: 'fas fa-compress-alt', description: 'Compress JPEG/PNG images to a smaller file size with high quality.' },
            { id: 'background-remover', name: 'Background Remover', icon: 'fas fa-eraser', description: 'Automatically remove the background from any image with one click.' },
            { id: 'channel-extractor', name: 'Channel Extractor', icon: 'fab fa-youtube', description: 'Extract data and generate new content from any YouTube video.' },
            { id: 'tags-generator', name: 'Video Tags Generator', icon: 'fas fa-tags', description: 'Generate optimized tags from a YouTube video URL.' },
            { id: 'keyword-suggester', name: 'Keyword Suggester', icon: 'fas fa-key', description: 'Get relevant keywords and tags for your video topic.' },
            { id: 'thumbnail-downloader', name: 'Thumbnail Downloader', icon: 'fas fa-image', description: 'Download any YouTube video\'s thumbnail in high quality.' },
            { id: 'find-competitors', name: 'Find Competitors', icon: 'fas fa-users', description: 'Get AI-powered analysis of competitor channels.' },
            { id: 'subscribe-link', name: 'Subscribe Link', icon: 'fas fa-link', description: 'Create a link that prompts users to subscribe to your channel.' },
            { id: 'money-calculator', name: 'Money Calculator', icon: 'fas fa-calculator', description: 'Estimate your potential YouTube earnings based on views and RPM.' },
            { id: 'title-capitalizer', name: 'Title Capitalizer', icon: 'fas fa-text-height', description: 'Properly capitalize your video titles with a single click.' },
            { id: 'embed-code', name: 'Embed Code', icon: 'fas fa-code', description: 'Generate HTML embed codes for your YouTube videos.' }
        ];

        // --- Page Templates ---
        const pageTemplates = {
            home: `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-12 text-center">
                        <h2 class="text-4xl md:text-5xl font-extrabold text-text-primary">Welcome to <span class="text-accent-primary">Talks Tools</span></h2>
                        <p class="text-text-secondary mt-2 text-lg h-8"><span id="animated-text" class="blinking-cursor"></span></p>
                    </header>
                    <div id="home-tools-grid" class="grid grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-12">
                        <!-- Tool cards will be injected here -->
                    </div>
                    <div class="result-card p-6">
                        <h3 class="text-2xl font-bold mb-6 text-center">About The Developer</h3>
                        <div class="flex flex-col md:flex-row items-center gap-8">
                            <div class="flex-shrink-0"><img src="https://placehold.co/150x150/00FFA3/0D0D0D?text=MT" alt="Mustafa Talks" class="rounded-full w-36 h-36 border-4 border-accent-primary"></div>
                            <div><h4 class="text-2xl font-bold text-accent-primary">Mustafa Talks</h4><p class="text-text-secondary mt-2">As a dedicated content creator and developer, I built Talks Tools from the ground up to solve the real-world problems creators face. My goal is to leverage the power of AI to handle the tedious tasks, freeing you to focus on what you do best: creating amazing, impactful content. This suite is my contribution to the creator communityâ€”I hope it helps you on your journey!</p></div>
                        </div>
                    </div>
                </div>`,
            'content-generator': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                            <h2 class="text-3xl font-extrabold">AI Content Generator</h2>
                            <p class="text-text-secondary mt-1">Create optimized Titles, Descriptions, and Tags.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="content-keyword-input" class="block text-lg font-semibold mb-3 text-accent-primary">Video Topic</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="content-keyword-input" class="w-full custom-input" placeholder="e.g., 'The future of AI in 2026'">
                            <button id="generate-content-btn" class="main-btn py-3 px-6 flex items-center justify-center whitespace-nowrap"><i class="fas fa-magic mr-2"></i><span class="btn-text">Generate</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button>
                        </div>
                    </div>
                    <div id="content-results-wrapper" class="space-y-6 hidden">
                        <div class="result-card p-6 fade-in"><h3 class="text-xl font-bold mb-4">Generated Titles</h3><div id="titles-output" class="space-y-3"></div></div>
                        <div class="result-card p-6 fade-in"><div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Generated Description</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy" id="copy-desc-btn"><i class="fas fa-copy text-lg"></i></button></div><div id="description-output" class="text-text-secondary whitespace-pre-wrap bg-bg-primary p-4 rounded-lg min-h-[120px]"></div></div>
                        <div class="result-card p-6 fade-in"><div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Generated Tags</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy" id="copy-tags-btn"><i class="fas fa-copy text-lg"></i></button></div><div id="tags-output" class="text-text-secondary bg-bg-primary p-4 rounded-lg min-h-[80px]"></div></div>
                        <div class="result-card p-6 fade-in"><div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Copyright Disclaimer</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy" id="copy-copyright-btn"><i class="fas fa-copy text-lg"></i></button></div><div id="copyright-output" class="text-sm text-text-secondary bg-bg-primary p-4 rounded-lg"></div></div>
                    </div>
                </div>`,
            'script-generator': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                            <h2 class="text-3xl font-extrabold">AI Script Generator</h2>
                            <p class="text-text-secondary mt-1">Generate a complete video script in any language and tone.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <h3 class="text-xl font-bold mb-4">Need help with a video idea?</h3>
                        <button id="show-idea-helper-btn" class="secondary-btn w-full py-2 px-4 flex items-center justify-center"><i class="fas fa-search mr-2"></i>Generate Video Ideas</button>
                        <div id="idea-helper-ui" class="hidden mt-4 pt-4 border-t border-border-color">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label for="idea-category-select" class="block text-sm font-semibold mb-2 text-accent-primary">Category</label><select id="idea-category-select" class="w-full custom-select"><option value="Tech">Tech</option><option value="Art">Art</option><option value="History">History</option><option value="Science">Science</option><option value="Music">Music</option><option value="Mystery">Mystery</option></select></div>
                                <div><label for="idea-keyword-input" class="block text-sm font-semibold mb-2 text-accent-primary">Keyword</label><input type="text" id="idea-keyword-input" class="w-full custom-input" placeholder="e.g., 'iPhone' or 'Rock music'"></div>
                            </div>
                            <button id="generate-ideas-btn" class="main-btn w-full py-2 px-4 mt-4 flex items-center justify-center"><i class="fas fa-lightbulb mr-2"></i><span class="btn-text">Get 5 Ideas</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button>
                            <div id="ideas-output" class="mt-4 space-y-2"></div>
                        </div>
                    </div>
                    <div class="result-card p-6 mb-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                            <div class="col-span-1 md:col-span-2"><label for="script-topic-input" class="block text-sm font-semibold mb-2 text-accent-primary">Video Topic</label><input type="text" id="script-topic-input" class="w-full custom-input" placeholder="Click an idea above or enter a topic"></div>
                            <div><label for="script-language-select" class="block text-sm font-semibold mb-2 text-accent-primary">Language</label><select id="script-language-select" class="w-full custom-select"><option value="Roman Urdu">Roman Urdu</option><option value="English">English</option><option value="Hindi (in Devanagari script)">Hindi</option><option value="Urdu">Urdu</option><option value="Spanish">Spanish</option><option value="Arabic">Arabic</option></select></div>
                            <div><label for="script-type-select" class="block text-sm font-semibold mb-2 text-accent-primary">Script Type</label><select id="script-type-select" class="w-full custom-select"><option value="Standard Storytelling">Standard Storytelling</option><option value="Tech Explainer">Tech Explainer</option><option value="Training/Tutorial">Training/Tutorial</option><option value="Explainer Video">Explainer Video</option><option value="Listicle (e.g., Top 5)">Listicle (e.g., Top 5)</option><option value="How-To Guide">How-To Guide</option><option value="Product Demo">Product Demo</option><option value="Vlog">Vlog</option><option value="Interview">Interview</option><option value="Review">Review</option></select></div>
                            <div class="col-span-1 md:col-span-2"><label for="script-tone-select" class="block text-sm font-semibold mb-2 text-accent-primary">Script Tone</label><select id="script-tone-select" class="w-full custom-select"><option value="Engaging & Informative">Engaging & Informative</option><option value="Mysterious & Suspenseful">Mysterious & Suspenseful</option><option value="Energetic & Fun">Energetic & Fun</option><option value="Professional & Authoritative">Professional & Authoritative</option><option value="Casual & Conversational">Casual & Conversational</option></select></div>
                            <div class="col-span-1 md:col-span-2"><label for="script-words-input" class="block text-sm font-semibold mb-2 text-accent-primary">Approximate Word Count</label><input type="number" id="script-words-input" class="w-full custom-input" placeholder="e.g., 1200"></div>
                        </div>
                        <div class="mt-6"><button id="generate-script-btn" class="main-btn w-full py-3 px-6 flex items-center justify-center"><i class="fas fa-file-alt mr-2"></i><span class="btn-text">Generate Script</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button></div>
                    </div>
                    <div id="script-results-wrapper" class="result-card p-6 hidden"><div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Generated Script</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Script" id="copy-script-btn"><i class="fas fa-copy text-lg"></i></button></div><div id="script-output" class="text-text-secondary whitespace-pre-wrap bg-bg-primary p-4 rounded-lg min-h-[200px]"></div></div>
                </div>`,
            'script-rewriter': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">AI Script Rewriter</h2>
                           <p class="text-text-secondary mt-1">Improve your script or get a better version from a YouTube video.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <div class="border-b border-border-color mb-4">
                            <nav class="-mb-px flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-8" aria-label="Tabs">
                                <button id="tab-rewrite-text" class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-lg border-accent-primary text-accent-primary">Rewrite My Script</button>
                                <button id="tab-rewrite-url" class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-lg border-transparent text-text-secondary hover:text-text-primary hover:border-gray-300">Rewrite from URL</button>
                            </nav>
                        </div>
                        <div id="panel-rewrite-text">
                            <label for="rewrite-input-text" class="block text-sm font-semibold mb-2 text-accent-primary">Paste your original script here</label>
                            <textarea id="rewrite-input-text" class="w-full custom-input min-h-[150px]" placeholder="Paste your script..."></textarea>
                            <label for="rewrite-upload-input" class="block text-sm font-semibold mt-4 mb-2 text-accent-primary">Or Upload a .txt File</label>
                            <input type="file" id="rewrite-upload-input" accept=".txt" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-bg-tertiary file:text-text-primary hover:file:bg-gray-600 cursor-pointer">
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                                <div><label for="rewrite-language-select" class="block text-sm font-semibold mb-2">Original Language</label><select id="rewrite-language-select" class="w-full custom-select"><option>English</option><option>Roman Urdu</option><option>Hindi</option><option>Spanish</option><option>German</option></select></div>
                                <div><label for="rewrite-tone-select" class="block text-sm font-semibold mb-2">Desired Tone</label><select id="rewrite-tone-select" class="w-full custom-select"><option>More Engaging</option><option>More Professional</option><option>More Casual</option><option>More Humorous</option><option>More Authoritative</option></select></div>
                                <div class="col-span-1 md:col-span-2"><label for="rewrite-words-input" class="block text-sm font-semibold mb-2">Desired Word Count (Max 500,000)</label><input type="number" id="rewrite-words-input" class="w-full custom-input" placeholder="e.g., 1500 (leave blank for similar length)"></div>
                            </div>
                        </div>
                        <div id="panel-rewrite-url" class="hidden">
                            <label for="rewrite-input-url" class="block text-sm font-semibold mb-2 text-accent-primary">YouTube Video URL</label>
                            <input type="text" id="rewrite-input-url" class="w-full custom-input" placeholder="e.g., https://www.youtube.com/watch?v=...">
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                                <div><label for="rewrite-url-tone-select" class="block text-sm font-semibold mb-2">Desired Tone</label><select id="rewrite-url-tone-select" class="w-full custom-select"><option>More Engaging</option><option>More Professional</option><option>More Casual</option><option>More Humorous</option><option>More Authoritative</option></select></div>
                                <div><label for="rewrite-url-words-input" class="block text-sm font-semibold mb-2">Desired Word Count</label><input type="number" id="rewrite-url-words-input" class="w-full custom-input" placeholder="e.g., 1500 (leave blank for similar length)"></div>
                            </div>
                        </div>
                        <div class="mt-6"><button id="rewrite-script-btn" class="main-btn w-full py-3 px-6 flex items-center justify-center"><i class="fas fa-feather-alt mr-2"></i><span class="btn-text">Rewrite Script</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button></div>
                    </div>
                    <div id="rewrite-results-wrapper" class="result-card p-6 hidden">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Rewritten Script</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Script" id="copy-rewritten-script-btn"><i class="fas fa-copy text-lg"></i></button></div>
                        <div id="rewritten-script-output" class="text-text-secondary whitespace-pre-wrap bg-bg-primary p-4 rounded-lg min-h-[200px]"></div>
                    </div>
                </div>`,
            'prompt-generator': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">AI Prompt Generator</h2>
                           <p class="text-text-secondary mt-1">Craft expert-level prompts for any AI model.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                            <div class="col-span-1 md:col-span-2"><label for="prompt-topic-input" class="block text-sm font-semibold mb-2 text-accent-primary">Your Topic / Idea</label><input type="text" id="prompt-topic-input" class="w-full custom-input" placeholder="e.g., 'A haunted spaceship' or 'A summary of climate change'"></div>
                            <div><label for="prompt-category-select" class="block text-sm font-semibold mb-2 text-accent-primary">Prompt Category</label><select id="prompt-category-select" class="w-full custom-select"><option value="">-- Select a Category --</option><option value="text-to-image">Text-to-Image</option><option value="text-to-video">Text-to-Video</option><option value="general-ai">General AI Interaction</option></select></div>
                            <div><label for="prompt-style-select" class="block text-sm font-semibold mb-2 text-accent-primary">Prompt Style</label><select id="prompt-style-select" class="w-full custom-select" disabled><option>-- Select Category First --</option></select></div>
                            <div class="col-span-1 md:col-span-2"><label for="prompt-quantity-input" class="block text-sm font-semibold mb-2 text-accent-primary">Number of Prompts</label><input type="number" id="prompt-quantity-input" class="w-full custom-input" value="1" min="1" max="10"></div>
                        </div>
                        <div class="mt-6"><button id="generate-prompt-btn" class="main-btn w-full py-3 px-6 flex items-center justify-center"><i class="fas fa-lightbulb mr-2"></i><span class="btn-text">Generate Prompts</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button></div>
                    </div>
                    <div id="prompt-results-wrapper" class="space-y-6 hidden"></div>
                    
                    <div class="result-card p-6 mt-8">
                        <h3 class="text-2xl font-bold mb-4">Thumbnail Prompt Inspiration</h3>
                        <p class="text-text-secondary mb-6">Generate detailed prompts for your thumbnails.</p>
                        <div class="space-y-4">
                            <div>
                                <label for="insp-idea-input" class="block text-sm font-semibold mb-2 text-accent-primary">Your Thumbnail Idea or Title</label>
                                <input type="text" id="insp-idea-input" class="w-full custom-input" placeholder="e.g., 'My New Gaming PC Build'">
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div><label for="insp-style-select" class="block text-sm font-semibold mb-2">Style</label><select id="insp-style-select" class="w-full custom-select"><option>Best/Default</option><option>Tech</option><option>Vlog</option><option>Gaming</option><option>Tutorial</option></select></div>
                                <div><label for="insp-tone-select" class="block text-sm font-semibold mb-2">Tone</label><select id="insp-tone-select" class="w-full custom-select"><option>Dramatic</option><option>Fun & Energetic</option><option>Clean & Minimalist</option><option>Bold & Exciting</option></select></div>
                                <div><label for="insp-length-select" class="block text-sm font-semibold mb-2">Prompt Length</label><select id="insp-length-select" class="w-full custom-select"><option>Medium</option><option>Short</option><option>Detailed</option></select></div>
                            </div>
                             <button id="generate-inspiration-prompt-btn" class="main-btn w-full py-2 px-4 mt-2">Generate Prompt from Idea</button>
                        </div>
                        <div class="text-center my-4 text-text-secondary">OR</div>
                        <div>
                            <label class="block text-sm font-semibold mb-2 text-accent-primary">Upload an Image for Inspiration</label>
                            <input type="file" id="inspiration-upload-input" accept="image/jpeg, image/png" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-bg-tertiary file:text-text-primary hover:file:bg-gray-600 cursor-pointer">
                        </div>
                        <div id="inspiration-prompt-output-wrapper" class="mt-6 hidden">
                            <div class="flex justify-between items-center mb-2"><h4 class="text-xl font-bold">Generated Prompt</h4><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Prompt" id="copy-inspiration-prompt-btn"><i class="fas fa-copy text-lg"></i></button></div>
                            <div id="inspiration-prompt-output" class="text-text-secondary whitespace-pre-wrap bg-bg-primary p-4 rounded-lg min-h-[100px]"></div>
                        </div>
                    </div>
                </div>`,
            'thumbnail-maker': `
                <div class="max-w-6xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">AI Thumbnail Maker</h2>
                           <p class="text-text-secondary mt-1">Generate stunning thumbnails from text or get inspired by a video.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    
                    <div class="result-card p-6 mb-8">
                        <div class="border-b border-border-color mb-4">
                            <nav class="-mb-px flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-8" aria-label="Tabs">
                                <button id="tab-create-ai" class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-lg border-accent-primary text-accent-primary">Create with AI</button>
                                <button id="tab-get-inspiration" class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-lg border-transparent text-text-secondary hover:text-text-primary hover:border-gray-300">Get Inspiration</button>
                            </nav>
                        </div>

                        <!-- Create with AI Panel -->
                        <div id="panel-create-ai">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <div class="lg:col-span-3"><label for="thumb-prompt-input" class="block text-sm font-semibold mb-2 text-accent-primary">Title / Idea / Prompt</label><input type="text" id="thumb-prompt-input" class="w-full custom-input" placeholder="e.g., 'Unboxing the new Galaxy Z Fold 10'"></div>
                                <div><label for="thumb-tone-select" class="block text-sm font-semibold mb-2 text-accent-primary">Tone</label><select id="thumb-tone-select" class="w-full custom-select"><option>Bold & Punchy</option><option>Minimalist & Clean</option><option>Cinematic & Dramatic</option><option>Playful & Fun</option><option>Futuristic & Techy</option></select></div>
                                <div><label for="thumb-type-select" class="block text-sm font-semibold mb-2 text-accent-primary">Type</label><select id="thumb-type-select" class="w-full custom-select"><option>Vlog</option><option>Gaming</option><option>Tech Review</option><option>Tutorial</option><option>Documentary</option></select></div>
                                <div><label for="thumb-ratio-select" class="block text-sm font-semibold mb-2 text-accent-primary">Aspect Ratio</label><select id="thumb-ratio-select" class="w-full custom-select"><option value="16:9">YouTube (16:9)</option><option value="9:16">TikTok/Shorts (9:16)</option></select></div>
                                <div class="lg:col-span-3"><label for="thumb-count-input" class="block text-sm font-semibold mb-2 text-accent-primary">Number to Generate</label><input type="number" id="thumb-count-input" class="w-full custom-input" value="2" min="1" max="4"></div>
                            </div>
                        </div>

                        <!-- Get Inspiration Panel -->
                        <div id="panel-get-inspiration" class="hidden">
                            <label class="block text-sm font-semibold mb-2 text-accent-primary">Get inspired by a URL or upload an image</label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><input type="text" id="thumb-url-input" class="w-full custom-input" placeholder="Paste a YouTube video link..."></div>
                                <div><input type="file" id="thumb-upload-input" accept="image/jpeg, image/png" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-bg-tertiary file:text-text-primary hover:file:bg-gray-600 cursor-pointer"></div>
                                <div class="md:col-span-2"><label for="thumb-ratio-select-inspire" class="block text-sm font-semibold mb-2 text-accent-primary">Aspect Ratio</label><select id="thumb-ratio-select-inspire" class="w-full custom-select"><option value="16:9">YouTube (16:9)</option><option value="9:16">TikTok/Shorts (9:16)</option></select></div>
                            </div>
                        </div>
                        
                        <div class="mt-6"><button id="generate-thumbnail-btn" class="main-btn w-full py-3 px-6 flex items-center justify-center"><i class="fas fa-image mr-2"></i><span class="btn-text">Generate Thumbnails</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button></div>
                    </div>

                    <div id="thumbnail-results-wrapper" class="hidden">
                        <h3 class="text-2xl font-bold mb-4">Generated Thumbnails</h3>
                        <div id="thumbnail-output" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Generated thumbnails will be injected here -->
                        </div>
                    </div>
                </div>`,
            'image-generation': `
                <div class="max-w-6xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                         <div>
                           <h2 class="text-3xl font-extrabold">AI Image Generation</h2>
                           <p class="text-text-secondary mt-1">Create any image from your imagination.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    
                    <div class="result-card p-6 mb-8">
                        <div class="border-b border-border-color mb-4">
                            <nav class="-mb-px flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-8" aria-label="Tabs">
                                <button id="tab-text-to-image" class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-lg border-accent-primary text-accent-primary">Text-to-Image</button>
                                <button id="tab-image-to-image" class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-lg border-transparent text-text-secondary hover:text-text-primary hover:border-gray-300">Image-to-Image</button>
                            </nav>
                        </div>

                        <!-- Text to Image Panel -->
                        <div id="panel-text-to-image">
                             <div class="mb-4"><label for="gen-prompt-input" class="block text-sm font-semibold mb-2 text-accent-primary">Your Prompt</label><textarea id="gen-prompt-input" class="w-full custom-input min-h-[100px]" placeholder="e.g., 'A hyper-realistic photo of a cat wearing sunglasses, studio lighting'"></textarea></div>
                             <div class="result-card p-4 mb-4">
                                <h4 class="text-lg font-semibold mb-3">Need an Idea?</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div><label for="gen-idea-topic" class="block text-sm font-semibold mb-2">Topic</label><input type="text" id="gen-idea-topic" class="w-full custom-input" placeholder="e.g., 'space' or 'fantasy creature'"></div>
                                    <div><label for="gen-idea-style" class="block text-sm font-semibold mb-2">Style</label><select id="gen-idea-style" class="w-full custom-select"><option>Photorealistic</option><option>Anime</option><option>3D Model</option><option>Digital Art</option><option>Pixel Art</option><option>Cinematic</option></select></div>
                                </div>
                                <button id="gen-idea-btn" class="secondary-btn w-full mt-4 py-2">Generate a Detailed Prompt</button>
                             </div>
                        </div>

                        <!-- Image to Image Panel -->
                        <div id="panel-image-to-image" class="hidden">
                             <div><label for="gen-image-upload" class="block text-sm font-semibold mb-2 text-accent-primary">Upload Your Sample Image</label><input type="file" id="gen-image-upload" accept="image/jpeg, image/png" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-bg-tertiary file:text-text-primary hover:file:bg-gray-600 cursor-pointer"></div>
                             <img id="gen-image-preview" class="mt-4 rounded-lg max-h-64 mx-auto hidden">
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                            <div><label for="gen-ratio-select" class="block text-sm font-semibold mb-2 text-accent-primary">Aspect Ratio</label><select id="gen-ratio-select" class="w-full custom-select"><option value="1:1">Square (1:1)</option><option value="16:9">Widescreen (16:9)</option><option value="9:16">Portrait (9:16)</option><option value="4:5">Social (4:5)</option><option value="2:3">Portrait (2:3)</option><option value="3:2">Landscape (3:2)</option></select></div>
                            <div><label for="gen-count-input" class="block text-sm font-semibold mb-2 text-accent-primary">Number to Generate</label><input type="number" id="gen-count-input" class="w-full custom-input" value="1" min="1" max="3"></div>
                        </div>

                        <div class="mt-6"><button id="generate-image-btn" class="main-btn w-full py-3 px-6 flex items-center justify-center"><i class="fas fa-image mr-2"></i><span class="btn-text">Generate Images</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button></div>
                    </div>

                    <div id="image-gen-results-wrapper" class="hidden">
                        <h3 class="text-2xl font-bold mb-4">Your Generated Images</h3>
                        <div id="image-gen-output" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- Generated images will be injected here -->
                        </div>
                    </div>
                </div>`,
            'image-compressor': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Image Compressor</h2>
                           <p class="text-text-secondary mt-1">Reduce image file size while maintaining quality.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="image-upload-input" class="block text-lg font-semibold mb-3 text-accent-primary">Upload Image</label>
                        <input type="file" id="image-upload-input" accept="image/jpeg, image/png" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-accent-primary file:text-bg-primary hover:file:bg-accent-hover cursor-pointer">
                        
                        <div id="image-quality-section" class="mt-6 hidden">
                            <label for="image-quality-slider" class="block text-lg font-semibold mb-3 text-accent-primary">Compression Quality: <span id="image-quality-value">0.9</span></label>
                            <input type="range" id="image-quality-slider" min="0.1" max="1" step="0.1" value="0.9" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-accent-primary">
                        </div>
                    </div>
                    <div id="image-compressor-results-wrapper" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="result-card p-4 text-center">
                            <h3 class="text-xl font-bold mb-4">Original Image</h3>
                            <img id="original-image-preview" src="https://placehold.co/600x400/1A1A1A/A3A3A3?text=Original+Image" class="w-full rounded-lg mx-auto mb-2">
                            <p id="original-image-size" class="text-text-secondary"></p>
                        </div>
                        <div class="result-card p-4 text-center">
                            <h3 class="text-xl font-bold mb-4">Compressed Image</h3>
                            <img id="compressed-image-preview" src="https://placehold.co/600x400/1A1A1A/A3A3A3?text=Compressed+Image" class="w-full rounded-lg mx-auto mb-2">
                            <p id="compressed-image-size" class="text-text-secondary mb-4"></p>
                            <button id="download-compressed-btn" class="main-btn py-2 px-5 inline-flex items-center" disabled><i class="fas fa-download mr-2"></i>Download Image</button>
                        </div>
                    </div>
                </div>`,
            'background-remover': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Image Background Remover</h2>
                           <p class="text-text-secondary mt-1">Automatically remove the background from any image.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="bg-remove-upload-input" class="block text-lg font-semibold mb-3 text-accent-primary">Upload Image</label>
                        <input type="file" id="bg-remove-upload-input" accept="image/jpeg, image/png" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-accent-primary file:text-bg-primary hover:file:bg-accent-hover cursor-pointer">
                        <p class="text-xs text-text-secondary mt-2">Note: This tool requires an API key from remove.bg. Paste it in the script to use.</p>
                    </div>
                    <div id="bg-remover-results-wrapper" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="result-card p-4 text-center">
                            <h3 class="text-xl font-bold mb-4">Original</h3>
                            <img id="original-bg-image-preview" src="https://placehold.co/600x400/1A1A1A/A3A3A3?text=Original+Image" class="w-full rounded-lg mx-auto mb-2">
                        </div>
                        <div class="result-card p-4 text-center relative">
                            <div id="bg-remover-loader" class="absolute inset-0 bg-bg-secondary/80 flex items-center justify-center hidden rounded-lg">
                                <div class="w-8 h-8 border-4 border-accent-primary border-t-transparent rounded-full animate-spin"></div>
                            </div>
                            <h3 class="text-xl font-bold mb-4">Background Removed</h3>
                            <img id="removed-bg-image-preview" src="https://placehold.co/600x400/1A1A1A/A3A3A3?text=Result" class="w-full rounded-lg mx-auto mb-2" style="background-image: url('data:image/svg+xml,%3Csvg width=\'20\' height=\'20\' viewBox=\'0 0 20 20\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Crect width=\'10\' height=\'10\' x=\'0\' y=\'0\' fill=\'%233a3a3a\'/%3E%3Crect width=\'10\' height=\'10\' x=\'10\' y=\'10\' fill=\'%233a3a3a\'/%3E%3C/svg%3E');">
                            <button id="download-removed-bg-btn" class="main-btn py-2 px-5 mt-4 inline-flex items-center" disabled><i class="fas fa-download mr-2"></i>Download HD</button>
                        </div>
                    </div>
                </div>`,
            'channel-extractor': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Channel Extractor</h2>
                           <p class="text-text-secondary mt-1">Extract data and generate new content from any YouTube video.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="extractor-url-input" class="block text-lg font-semibold mb-3 text-accent-primary">YouTube Video URL</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="extractor-url-input" class="w-full custom-input" placeholder="e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ">
                            <button id="extract-btn" class="main-btn py-3 px-6 flex items-center justify-center whitespace-nowrap"><i class="fas fa-search mr-2"></i><span class="btn-text">Extract & Generate</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button>
                        </div>
                    </div>
                    <div id="extractor-results-wrapper" class="space-y-6 hidden">
                        <div class="result-card p-6 fade-in">
                            <h3 class="text-xl font-bold mb-4">Thumbnail</h3>
                            <div class="text-center">
                                <img id="extractor-thumbnail-output" src="" alt="Video Thumbnail" class="w-full max-w-md mx-auto rounded-lg">
                                <button id="download-thumbnail-btn" class="secondary-btn py-2 px-5 mt-4 inline-flex items-center"><i class="fas fa-download mr-2"></i>Download Thumbnail</button>
                            </div>
                        </div>
                        <div class="result-card p-6 fade-in">
                            <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Video Title</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Title" id="copy-extractor-title-btn"><i class="fas fa-copy text-lg"></i></button></div>
                            <div id="extractor-title-output" class="text-text-secondary whitespace-pre-wrap bg-bg-primary p-4 rounded-lg"></div>
                        </div>
                        <div class="result-card p-6 fade-in">
                             <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Generated Description</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Description" id="copy-extractor-desc-btn"><i class="fas fa-copy text-lg"></i></button></div>
                            <div id="extractor-desc-output" class="text-text-secondary whitespace-pre-wrap bg-bg-primary p-4 rounded-lg min-h-[120px]"></div>
                        </div>
                         <div class="result-card p-6 fade-in">
                             <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Generated Tags</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Tags" id="copy-extractor-tags-btn"><i class="fas fa-copy text-lg"></i></button></div>
                            <div id="extractor-tags-output" class="text-text-secondary bg-bg-primary p-4 rounded-lg min-h-[80px]"></div>
                        </div>
                    </div>
                </div>`,
            'tags-generator': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Video Tags Generator</h2>
                           <p class="text-text-secondary mt-1">Generate optimized tags from a YouTube video URL.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="tags-url-input" class="block text-lg font-semibold mb-3 text-accent-primary">YouTube Video URL</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="tags-url-input" class="w-full custom-input" placeholder="e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ">
                            <button id="generate-tags-from-url-btn" class="main-btn py-3 px-6 flex items-center justify-center whitespace-nowrap"><i class="fas fa-tags mr-2"></i><span class="btn-text">Generate Tags</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button>
                        </div>
                    </div>
                    <div id="tags-generator-results-wrapper" class="result-card p-6 hidden">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Generated Tags</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Tags" id="copy-generated-tags-btn"><i class="fas fa-copy text-lg"></i></button></div>
                        <div id="tags-generator-output" class="text-text-secondary bg-bg-primary p-4 rounded-lg min-h-[80px]"></div>
                    </div>
                </div>`,
            'keyword-suggester': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Keyword Suggester</h2>
                           <p class="text-text-secondary mt-1">Get relevant keywords and tags for your video topic.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="keyword-suggester-input" class="block text-lg font-semibold mb-3 text-accent-primary">Video Title or Topic</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="keyword-suggester-input" class="w-full custom-input" placeholder="e.g., 'Best budget gaming laptops 2025'">
                            <button id="generate-keywords-btn" class="main-btn py-3 px-6 flex items-center justify-center whitespace-nowrap"><i class="fas fa-key mr-2"></i><span class="btn-text">Suggest Keywords</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button>
                        </div>
                    </div>
                    <div id="keyword-suggester-results-wrapper" class="result-card p-6 hidden">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Suggested Keywords</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Keywords" id="copy-suggested-keywords-btn"><i class="fas fa-copy text-lg"></i></button></div>
                        <div id="keyword-suggester-output" class="text-text-secondary bg-bg-primary p-4 rounded-lg min-h-[80px]"></div>
                    </div>
                </div>`,
            'thumbnail-downloader': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Thumbnail Downloader</h2>
                           <p class="text-text-secondary mt-1">Download any YouTube video's thumbnail in high quality.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="thumbnail-url-input" class="block text-lg font-semibold mb-3 text-accent-primary">YouTube Video URL</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="thumbnail-url-input" class="w-full custom-input" placeholder="e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ">
                            <button id="get-thumbnail-btn" class="main-btn py-3 px-6 flex items-center justify-center whitespace-nowrap"><i class="fas fa-image mr-2"></i><span class="btn-text">Get Thumbnail</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button>
                        </div>
                    </div>
                    <div id="thumbnail-downloader-results-wrapper" class="result-card p-6 hidden text-center">
                        <h3 class="text-xl font-bold mb-4">Your Thumbnail</h3>
                        <img id="thumbnail-downloader-output" src="" alt="Video Thumbnail" class="w-full max-w-md mx-auto rounded-lg">
                        <button id="download-standalone-thumbnail-btn" class="main-btn py-2 px-5 mt-4 inline-flex items-center"><i class="fas fa-download mr-2"></i>Download Thumbnail</button>
                    </div>
                </div>`,
            'find-competitors': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Find Competitors</h2>
                           <p class="text-text-secondary mt-1">Get AI-powered analysis of competitor channels.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="competitor-topic-input" class="block text-lg font-semibold mb-3 text-accent-primary">Channel URL or Handle</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="competitor-topic-input" class="w-full custom-input" placeholder="e.g., @MrBeast or https://www.youtube.com/@MrBeast">
                            <button id="find-competitors-btn" class="main-btn py-3 px-6 flex items-center justify-center whitespace-nowrap"><i class="fas fa-users mr-2"></i><span class="btn-text">Find Competitors</span><div class="spinner hidden w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></div></button>
                        </div>
                        <p class="text-xs text-text-secondary mt-3 text-center">Note: All data is AI-estimated for analytical purposes only.</p>
                    </div>
                    <div id="competitor-results-wrapper" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 hidden">
                        <!-- Competitor cards will be injected here -->
                    </div>
                </div>`,
            'subscribe-link': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Subscribe Link Generator</h2>
                           <p class="text-text-secondary mt-1">Create a link that prompts users to subscribe.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="subscribe-url-input" class="block text-lg font-semibold mb-3 text-accent-primary">Your YouTube Channel URL</label>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="subscribe-url-input" class="w-full custom-input" placeholder="e.g., https://www.youtube.com/channel/UCX6OQ3DkcsbYNE6H8uQQuVA">
                            <button id="generate-subscribe-link-btn" class="main-btn py-3 px-6 flex items-center justify-center whitespace-nowrap"><i class="fas fa-link mr-2"></i><span class="btn-text">Generate Link</span></button>
                        </div>
                    </div>
                    <div id="subscribe-link-results-wrapper" class="result-card p-6 hidden">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Your Subscribe Link</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Link" id="copy-subscribe-link-btn"><i class="fas fa-copy text-lg"></i></button></div>
                        <div id="subscribe-link-output" class="text-text-secondary bg-bg-primary p-4 rounded-lg break-all"></div>
                    </div>
                </div>`,
            'money-calculator': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">YouTube Money Calculator</h2>
                           <p class="text-text-secondary mt-1">Estimate your potential earnings.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="calculator-views-input" class="block text-sm font-semibold mb-2 text-accent-primary">Daily Views</label><input type="number" id="calculator-views-input" class="w-full custom-input" placeholder="e.g., 50000"></div>
                            <div><label for="calculator-rpm-input" class="block text-sm font-semibold mb-2 text-accent-primary">Estimated RPM ($)</label><input type="number" id="calculator-rpm-input" class="w-full custom-input" placeholder="e.g., 1.50"></div>
                        </div>
                    </div>
                    <div id="calculator-results-wrapper" class="grid grid-cols-1 md:grid-cols-3 gap-6 hidden">
                        <div class="result-card p-6 text-center"><p class="text-text-secondary text-sm">Est. Daily Earnings</p><p id="calculator-daily-output" class="text-2xl font-bold text-accent-primary mt-1">$0.00</p></div>
                        <div class="result-card p-6 text-center"><p class="text-text-secondary text-sm">Est. Monthly Earnings</p><p id="calculator-monthly-output" class="text-2xl font-bold text-accent-primary mt-1">$0.00</p></div>
                        <div class="result-card p-6 text-center"><p class="text-text-secondary text-sm">Est. Yearly Earnings</p><p id="calculator-yearly-output" class="text-2xl font-bold text-accent-primary mt-1">$0.00</p></div>
                    </div>
                </div>`,
            'title-capitalizer': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">Video Title Capitalizer</h2>
                           <p class="text-text-secondary mt-1">Properly capitalize your video titles.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="capitalize-input" class="block text-lg font-semibold mb-3 text-accent-primary">Enter Title Here</label>
                        <textarea id="capitalize-input" class="w-full custom-input min-h-[100px]" placeholder="e.g., my awesome new video about tech"></textarea>
                        <button id="capitalize-btn" class="main-btn w-full mt-4 py-3 px-6 flex items-center justify-center"><i class="fas fa-text-height mr-2"></i><span class="btn-text">Capitalize Title</span></button>
                    </div>
                    <div id="capitalize-results-wrapper" class="result-card p-6 hidden">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Capitalized Title</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Title" id="copy-capitalized-btn"><i class="fas fa-copy text-lg"></i></button></div>
                        <div id="capitalize-output" class="text-text-secondary bg-bg-primary p-4 rounded-lg"></div>
                    </div>
                </div>`,
            'embed-code': `
                <div class="max-w-4xl mx-auto">
                    <header class="mb-8 flex justify-between items-center">
                        <div>
                           <h2 class="text-3xl font-extrabold">YouTube Embed Code Generator</h2>
                           <p class="text-text-secondary mt-1">Create embed codes for your videos.</p>
                        </div>
                        <button class="back-to-home-btn secondary-btn p-2 text-xl flex items-center justify-center w-10 h-10"><i class="fas fa-arrow-left"></i></button>
                    </header>
                    <div class="result-card p-6 mb-8">
                        <label for="embed-url-input" class="block text-lg font-semibold mb-3 text-accent-primary">YouTube Video URL</label>
                        <input type="text" id="embed-url-input" class="w-full custom-input" placeholder="e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                            <div><label for="embed-width-input" class="block text-sm font-semibold mb-2">Width</label><input type="text" id="embed-width-input" class="w-full custom-input" value="560"></div>
                            <div><label for="embed-height-input" class="block text-sm font-semibold mb-2">Height</label><input type="text" id="embed-height-input" class="w-full custom-input" value="315"></div>
                        </div>
                        <button id="generate-embed-btn" class="main-btn w-full mt-4 py-3 px-6 flex items-center justify-center"><i class="fas fa-code mr-2"></i><span class="btn-text">Generate Code</span></button>
                    </div>
                    <div id="embed-results-wrapper" class="result-card p-6 hidden">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Embed Code</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Code" id="copy-embed-btn"><i class="fas fa-copy text-lg"></i></button></div>
                        <textarea id="embed-output" class="w-full custom-input min-h-[150px]" readonly></textarea>
                    </div>
                </div>`,
        };

        // --- State ---
        let popupTimeout;
        let generatedData = {
            title: '', description: '', tags: '', copyright: '',
            script: '', prompts: [],
            extractorTitle: '', extractorDesc: '', extractorTags: '',
            generatedTags: '', suggestedKeywords: '',
            subscribeLink: '', capitalizedTitle: '', embedCode: '',
            compressedImageDataUrl: null, compressedImageFileName: '',
            removedBgImageUrl: null, removedBgImageFileName: '',
            generatedThumbnails: [],
            rewrittenScript: ''
        };

        const pages = {};

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // This function now runs completely to build the UI first.
            // The maintenance mode check is moved to the end.

            Object.keys(pageTemplates).forEach(pageId => {
                pages[pageId] = document.getElementById(`page-${pageId}`);
                const pageElement = pages[pageId];
                if (pageElement && pageTemplates[pageId]) {
                    pageElement.innerHTML = pageTemplates[pageId];
                }
            });

            const mainNav = document.getElementById('main-nav');
            const homeToolsGrid = document.getElementById('home-tools-grid');

            tools.forEach(tool => {
                const navLink = document.createElement('a');
                navLink.href = '#';
                navLink.id = `nav-${tool.id}`;
                navLink.dataset.page = tool.id;
                navLink.className = 'nav-trigger sidebar-link flex items-center gap-4 p-3 rounded-lg hover:bg-tertiary transition-colors';
                navLink.innerHTML = `<i class="${tool.icon} fa-fw sidebar-icon"></i><span>${tool.name}</span>`;
                mainNav.appendChild(navLink);

                if (homeToolsGrid) {
                    const toolCard = document.createElement('a');
                    toolCard.href = '#';
                    toolCard.className = 'nav-trigger result-card p-6 hover:border-accent-primary transition-colors';
                    toolCard.dataset.page = tool.id;
                    toolCard.innerHTML = `
                        <i class="${tool.icon} fa-2x text-accent-primary mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">${tool.name}</h3>
                        <p class="text-text-secondary text-sm">${tool.description}</p>
                    `;
                    homeToolsGrid.appendChild(toolCard);
                }
            });

            document.getElementById('nav-home').classList.add('active');
            Object.keys(pages).filter(p => p !== 'home').forEach(p => pages[p].classList.add('hidden'));
            pages['home'].classList.remove('hidden');

            bindAllEventListeners();
            if (pages['home']) {
                startTypewriter();
            }

            // Check for maintenance mode after the entire UI has been rendered
            if (isMaintenanceMode) {
                const overlay = document.getElementById('maintenance-overlay');
                overlay.classList.remove('hidden');
                overlay.classList.add('flex'); // Use flex to enable centering
            }
        });

        // --- Event Listeners Binding ---
        function bindAllEventListeners() {
            const get = (id) => document.getElementById(id);

            document.querySelectorAll('.nav-trigger').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = link.dataset.page;

                    const sidebar = get('sidebar');
                    const overlay = get('overlay');
                    if(sidebar && !sidebar.classList.contains('-translate-x-full')) {
                        toggleMenu();
                    }

                    if (pages[pageId]) {
                        document.querySelectorAll('.sidebar-link').forEach(nav => nav.classList.remove('active'));
                        get(`nav-${pageId}`)?.classList.add('active');
                        Object.values(pages).forEach(page => page.classList.add('hidden'));
                        pages[pageId].classList.remove('hidden');
                    } else {
                        showPopup("This tool is coming soon in a future update!", 'info');
                    }
                });
            });
            
            document.body.addEventListener('click', function(e) {
                if (e.target.closest('.back-to-home-btn')) {
                    e.preventDefault();
                    const homeLink = document.querySelector('.nav-trigger[data-page="home"]');
                    if (homeLink) {
                        homeLink.click();
                    }
                }
            });

            document.querySelectorAll('.coming-soon-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    showPopup("This page is coming soon!", 'info');
                });
            });

            get('hamburger-btn')?.addEventListener('click', toggleMenu);
            get('overlay')?.addEventListener('click', toggleMenu);

            // Bind listeners for each page
            get('generate-content-btn')?.addEventListener('click', handleContentGeneration);
            get('copy-desc-btn')?.addEventListener('click', () => copyToClipboard(generatedData.description));
            get('copy-tags-btn')?.addEventListener('click', () => copyToClipboard(generatedData.tags));
            get('copy-copyright-btn')?.addEventListener('click', () => copyToClipboard(generatedData.copyright));

            get('show-idea-helper-btn')?.addEventListener('click', () => get('idea-helper-ui').classList.toggle('hidden'));
            get('generate-ideas-btn')?.addEventListener('click', handleIdeaGeneration);
            get('generate-script-btn')?.addEventListener('click', handleScriptGeneration);
            get('copy-script-btn')?.addEventListener('click', () => copyToClipboard(generatedData.script));

            get('prompt-category-select')?.addEventListener('change', updatePromptStyles);
            get('generate-prompt-btn')?.addEventListener('click', handlePromptGeneration);
            get('generate-inspiration-prompt-btn')?.addEventListener('click', handleInspirationPromptGeneration);
            get('inspiration-upload-input')?.addEventListener('change', handleInspirationUpload);
            get('copy-inspiration-prompt-btn')?.addEventListener('click', () => copyToClipboard(document.getElementById('inspiration-prompt-output').innerText));


            get('extract-btn')?.addEventListener('click', handleExtraction);
            get('download-thumbnail-btn')?.addEventListener('click', () => downloadImage(get('extractor-thumbnail-output').src, generatedData.extractorTitle));
            get('copy-extractor-title-btn')?.addEventListener('click', () => copyToClipboard(generatedData.extractorTitle));
            get('copy-extractor-desc-btn')?.addEventListener('click', () => copyToClipboard(generatedData.extractorDesc));
            get('copy-extractor-tags-btn')?.addEventListener('click', () => copyToClipboard(generatedData.extractorTags));

            get('generate-tags-from-url-btn')?.addEventListener('click', handleTagsFromUrlGeneration);
            get('copy-generated-tags-btn')?.addEventListener('click', () => copyToClipboard(generatedData.generatedTags));

            get('generate-keywords-btn')?.addEventListener('click', handleKeywordSuggestion);
            get('copy-suggested-keywords-btn')?.addEventListener('click', () => copyToClipboard(generatedData.suggestedKeywords));

            get('get-thumbnail-btn')?.addEventListener('click', handleThumbnailDownload);
            get('download-standalone-thumbnail-btn')?.addEventListener('click', () => downloadImage(get('thumbnail-downloader-output').src, 'thumbnail'));

            get('find-competitors-btn')?.addEventListener('click', handleFindCompetitors);

            get('generate-subscribe-link-btn')?.addEventListener('click', handleSubscribeLink);
            get('copy-subscribe-link-btn')?.addEventListener('click', () => copyToClipboard(generatedData.subscribeLink));

            get('calculator-views-input')?.addEventListener('input', handleMoneyCalculation);
            get('calculator-rpm-input')?.addEventListener('input', handleMoneyCalculation);

            get('capitalize-btn')?.addEventListener('click', handleCapitalization);
            get('copy-capitalized-btn')?.addEventListener('click', () => copyToClipboard(generatedData.capitalizedTitle));

            get('generate-embed-btn')?.addEventListener('click', handleEmbedCodeGeneration);
            get('copy-embed-btn')?.addEventListener('click', () => copyToClipboard(generatedData.embedCode));

            // Image Compressor Listeners
            get('image-upload-input')?.addEventListener('change', handleImageUpload);
            get('image-quality-slider')?.addEventListener('input', handleImageCompression);
            get('download-compressed-btn')?.addEventListener('click', downloadCompressedImage);

            // Background Remover Listeners
            get('bg-remove-upload-input')?.addEventListener('change', handleBgRemoval);
            get('download-removed-bg-btn')?.addEventListener('click', downloadRemovedBgImage);

            // Thumbnail Maker Listeners
            get('tab-create-ai')?.addEventListener('click', () => switchThumbnailTab('create-ai'));
            get('tab-get-inspiration')?.addEventListener('click', () => switchThumbnailTab('get-inspiration'));
            get('generate-thumbnail-btn')?.addEventListener('click', handleThumbnailGeneration);
            
            // Image Generation Listeners
            get('tab-text-to-image')?.addEventListener('click', () => switchImageGenTab('text-to-image'));
            get('tab-image-to-image')?.addEventListener('click', () => switchImageGenTab('image-to-image'));
            get('gen-idea-btn')?.addEventListener('click', generateImageIdea);
            get('gen-image-upload')?.addEventListener('change', handleGenImageUpload);
            get('generate-image-btn')?.addEventListener('click', handleImageGeneration);
            
            // Script Rewriter Listeners
            get('tab-rewrite-text')?.addEventListener('click', () => switchScriptRewriteTab('text'));
            get('tab-rewrite-url')?.addEventListener('click', () => switchScriptRewriteTab('url'));
            get('rewrite-script-btn')?.addEventListener('click', handleScriptRewrite);
            get('copy-rewritten-script-btn')?.addEventListener('click', () => copyToClipboard(generatedData.rewrittenScript));
            get('rewrite-upload-input')?.addEventListener('change', handleScriptFileUpload);
            
            // Scroll to Top Listener
            get('scroll-to-top-btn')?.addEventListener('click', () => {
                get('main-content').scrollTo({ top: 0, behavior: 'smooth' });
            });
            get('main-content')?.addEventListener('scroll', () => {
                const scrollToTopBtn = get('scroll-to-top-btn');
                if (get('main-content').scrollTop > 200) {
                    scrollToTopBtn.classList.remove('hidden');
                    scrollToTopBtn.classList.add('flex');
                } else {
                    scrollToTopBtn.classList.add('hidden');
                    scrollToTopBtn.classList.remove('flex');
                }
            });
        }


        // --- Core Functions ---
        function toggleMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            sidebar.classList.toggle('-translate-x-full');
            overlay.classList.toggle('hidden');
        }

        function toggleButtonLoading(button, isLoading) {
            const btnText = button.querySelector('.btn-text');
            const spinner = button.querySelector('.spinner');
            button.disabled = isLoading;
            if(btnText) btnText.style.display = isLoading ? 'none' : 'inline';
            if(spinner) spinner.style.display = isLoading ? 'block' : 'none';
        }
        
        async function callOpenAITextApi(prompt) {
            const response = await fetch("https://api.openai.com/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${OPENAI_API_KEY}`
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo",
                    messages: [{ "role": "user", "content": prompt }],
                }),
            });
            if (!response.ok) {
                const error = await response.json();
                showPopup(`API Error: ${error.error.message}`, 'error');
                return null;
            }
            const result = await response.json();
            return result.choices[0].message.content;
        }

        async function callOpenAIImageApi(prompt) {
            const response = await fetch("https://api.openai.com/v1/images/generations", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${OPENAI_API_KEY}`
                },
                body: JSON.stringify({
                    model: "dall-e-2",
                    prompt: prompt,
                    n: 1,
                    size: "1024x1024"
                }),
            });
             if (!response.ok) {
                const error = await response.json();
                showPopup(`API Error: ${error.error.message}`, 'error');
                return null;
            }
            const result = await response.json();
            return result.data[0].url;
        }

        async function callOpenAIVisionApi(base64Image) {
             const response = await fetch("https://api.openai.com/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${OPENAI_API_KEY}`
                },
                body: JSON.stringify({
                    model: "gpt-4-vision-preview",
                    messages: [
                        {
                            "role": "user",
                            "content": [
                                { "type": "text", "text": "Analyze this image and create a detailed prompt for an AI image generator to create a similar high-quality thumbnail. Describe the style, colors, composition, subject, and mood." },
                                {
                                    "type": "image_url",
                                    "image_url": {
                                        "url": `data:image/jpeg;base64,${base64Image}`
                                    }
                                }
                            ]
                        }
                    ],
                    "max_tokens": 300
                })
            });
            if (!response.ok) {
                const error = await response.json();
                showPopup(`API Error: ${error.error.message}`, 'error');
                return null;
            }
            const result = await response.json();
            return result.choices[0].message.content;
        }
        
        // --- Script Rewriter Logic ---
        function switchScriptRewriteTab(tabId) {
            const textTab = document.getElementById('tab-rewrite-text');
            const urlTab = document.getElementById('tab-rewrite-url');
            const textPanel = document.getElementById('panel-rewrite-text');
            const urlPanel = document.getElementById('panel-rewrite-url');

            if (tabId === 'text') {
                textTab.classList.add('border-accent-primary', 'text-accent-primary');
                textTab.classList.remove('border-transparent', 'text-text-secondary');
                urlTab.classList.add('border-transparent', 'text-text-secondary');
                urlTab.classList.remove('border-accent-primary', 'text-accent-primary');
                textPanel.classList.remove('hidden');
                urlPanel.classList.add('hidden');
            } else {
                urlTab.classList.add('border-accent-primary', 'text-accent-primary');
                urlTab.classList.remove('border-transparent', 'text-text-secondary');
                textTab.classList.add('border-transparent', 'text-text-secondary');
                textTab.classList.remove('border-accent-primary', 'text-accent-primary');
                urlPanel.classList.remove('hidden');
                textPanel.classList.add('hidden');
            }
        }

        function handleScriptFileUpload(event) {
            const file = event.target.files[0];
            if (file && file.type === 'text/plain') {
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('rewrite-input-text').value = e.target.result;
                };
                reader.readAsText(file);
            } else if (file) {
                showPopup("Please upload a valid .txt file.", 'error');
            }
        }

        async function handleScriptRewrite() {
            const button = document.getElementById('rewrite-script-btn');
            toggleButtonLoading(button, true);

            const resultsWrapper = document.getElementById('rewrite-results-wrapper');
            const outputDiv = document.getElementById('rewritten-script-output');
            resultsWrapper.classList.add('hidden');
            outputDiv.innerText = '';

            const isTextMode = !document.getElementById('panel-rewrite-text').classList.contains('hidden');
            let originalScript = '';
            let rewritePrompt = '';

            if (isTextMode) {
                originalScript = document.getElementById('rewrite-input-text').value.trim();
                 if (!originalScript) {
                    showPopup("Please paste or upload your script to rewrite.", 'error');
                    toggleButtonLoading(button, false);
                    return;
                }
                const language = document.getElementById('rewrite-language-select').value;
                const tone = document.getElementById('rewrite-tone-select').value;
                const words = document.getElementById('rewrite-words-input').value;
                const lengthInstruction = words ? `The final script should be approximately ${words} words long.` : `The final script should be of similar length to the original.`;
                
                rewritePrompt = `You are an expert script editor. The original script is in ${language}. Rewrite the following script to be ${tone}. ${lengthInstruction} Improve the hook, flow, and call to action. Here is the original script:\n\n---\n\n${originalScript}`;
            } else { // URL Mode
                const url = document.getElementById('rewrite-input-url').value.trim();
                const tone = document.getElementById('rewrite-url-tone-select').value;
                const words = document.getElementById('rewrite-url-words-input').value;
                const lengthInstruction = words ? `The final script should be approximately ${words} words long.` : `The final script should be of similar length to the original.`;

                if (!url) {
                    showPopup("Please enter a YouTube URL.", 'error');
                    toggleButtonLoading(button, false);
                    return;
                }
                const videoId = getYouTubeID(url);
                if (!videoId) {
                    showPopup("Invalid YouTube URL.", 'error');
                    toggleButtonLoading(button, false);
                    return;
                }
                const title = await getVideoTitle(videoId);
                if (!title) {
                    toggleButtonLoading(button, false);
                    return;
                }
                // Note: True transcript extraction is very complex. We'll ask the AI to generate a script based on the title, then rewrite it.
                rewritePrompt = `First, act as a scriptwriter and generate a detailed script for a YouTube video titled "${title}". Then, act as an expert editor and rewrite that script from start to finish to be ${tone}. ${lengthInstruction} Make it significantly more engaging, professional, and captivating for the audience. The final output should ONLY be the rewritten, improved script.`;
            }

            const rewrittenScript = await callOpenAITextApi(rewritePrompt);
            if (rewrittenScript) {
                generatedData.rewrittenScript = rewrittenScript;
                outputDiv.innerText = rewrittenScript;
                resultsWrapper.classList.remove('hidden');
            }

            toggleButtonLoading(button, false);
        }

        // --- Thumbnail Maker Logic ---
        function switchThumbnailTab(tabId) {
            const createTab = document.getElementById('tab-create-ai');
            const inspireTab = document.getElementById('tab-get-inspiration');
            const createPanel = document.getElementById('panel-create-ai');
            const inspirePanel = document.getElementById('panel-get-inspiration');

            if (tabId === 'create-ai') {
                createTab.classList.add('border-accent-primary', 'text-accent-primary');
                createTab.classList.remove('border-transparent', 'text-text-secondary');
                inspireTab.classList.add('border-transparent', 'text-text-secondary');
                inspireTab.classList.remove('border-accent-primary', 'text-accent-primary');
                createPanel.classList.remove('hidden');
                inspirePanel.classList.add('hidden');
            } else {
                inspireTab.classList.add('border-accent-primary', 'text-accent-primary');
                inspireTab.classList.remove('border-transparent', 'text-text-secondary');
                createTab.classList.add('border-transparent', 'text-text-secondary');
                createTab.classList.remove('border-accent-primary', 'text-accent-primary');
                inspirePanel.classList.remove('hidden');
                createPanel.classList.add('hidden');
            }
        }

        async function handleThumbnailGeneration() {
            const button = document.getElementById('generate-thumbnail-btn');
            toggleButtonLoading(button, true);

            const resultsWrapper = document.getElementById('thumbnail-results-wrapper');
            const outputDiv = document.getElementById('thumbnail-output');
            resultsWrapper.classList.remove('hidden');
            outputDiv.innerHTML = `<div class="col-span-1 md:col-span-2 flex justify-center items-center p-8"><div class="w-8 h-8 border-4 border-accent-primary border-t-transparent rounded-full animate-spin"></div><p class="ml-4">Generating... this may take a moment.</p></div>`;

            const createPanel = document.getElementById('panel-create-ai');
            const isCreateMode = !createPanel.classList.contains('hidden');
            
            let allGeneratedImages = [];

            if (isCreateMode) {
                const idea = document.getElementById('thumb-prompt-input').value.trim();
                const tone = document.getElementById('thumb-tone-select').value;
                const type = document.getElementById('thumb-type-select').value;
                const count = parseInt(document.getElementById('thumb-count-input').value, 10);

                if (!idea) {
                    showPopup("Please enter a title or idea.", 'error');
                    toggleButtonLoading(button, false);
                    return;
                }
                const masterPrompt = `Act as a professional YouTube thumbnail designer. Create a visually stunning, high-impact thumbnail for a "${type}" video with a "${tone}" tone. The core idea is: "${idea}". The thumbnail must be eye-catching, with clear composition, vibrant colors, and easily readable text if any. Focus on creating a dynamic and professional image.`;
                for(let i = 0; i < count; i++){
                    const imageUrl = await callOpenAIImageApi(masterPrompt);
                    if(imageUrl) allGeneratedImages.push(imageUrl);
                }

            } else { // Inspiration Mode
                const url = document.getElementById('thumb-url-input').value.trim();
                const fileInput = document.getElementById('thumb-upload-input');
                const file = fileInput.files[0];
                const count = 2; // Fixed to 2 for inspiration mode

                if (!url && !file) {
                    showPopup("Please enter a YouTube URL or upload an image.", 'error');
                    toggleButtonLoading(button, false);
                    return;
                }

                if(url) {
                    const videoId = getYouTubeID(url);
                    if (!videoId) {
                        showPopup("Invalid YouTube URL.", 'error');
                        toggleButtonLoading(button, false);
                        return;
                    }
                    const title = await getVideoTitle(videoId);
                    if (!title) {
                        toggleButtonLoading(button, false);
                        return;
                    }
                    const masterPrompt = `Act as a professional YouTube thumbnail designer. A user wants to create a new thumbnail inspired by an existing video titled "${title}". Create a visually stunning, high-impact thumbnail that captures the essence of this title but offers a fresh, clickable visual concept. Focus on dynamic composition, vibrant colors, and professional quality.`;
                     for(let i = 0; i < count; i++){
                        const imageUrl = await callOpenAIImageApi(masterPrompt);
                        if(imageUrl) allGeneratedImages.push(imageUrl);
                    }
                } else { // Inspiration from uploaded image
                    const base64Image = await fileToBase64(file);
                    const generatedPrompt = await callOpenAIVisionApi(base64Image);
                    if(generatedPrompt){
                        for(let i = 0; i < count; i++){
                            const imageUrl = await callOpenAIImageApi(generatedPrompt);
                            if(imageUrl) allGeneratedImages.push(imageUrl);
                        }
                    }
                }
            }
            
            generatedData.generatedThumbnails = allGeneratedImages;
            displayGeneratedThumbnails(allGeneratedImages);
            toggleButtonLoading(button, false);
        }

        function displayGeneratedThumbnails(images) {
            const outputDiv = document.getElementById('thumbnail-output');
            outputDiv.innerHTML = '';
            if (!images || images.length === 0) {
                outputDiv.innerHTML = `<p class="col-span-1 md:col-span-2 text-center text-text-secondary">Generation failed. Please try again.</p>`;
                return;
            }

            images.forEach((imageUrl, index) => {
                const card = document.createElement('div');
                card.className = 'result-card p-4 text-center fade-in';
                card.innerHTML = `
                    <img src="${imageUrl}" class="w-full rounded-lg mx-auto mb-4" alt="Generated Thumbnail ${index + 1}">
                    <button class="download-thumb-btn main-btn py-2 px-5 inline-flex items-center" data-url="${imageUrl}" data-index="${index}">
                        <i class="fas fa-download mr-2"></i>Download
                    </button>
                `;
                outputDiv.appendChild(card);
            });

            document.querySelectorAll('.download-thumb-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const url = e.currentTarget.dataset.url;
                    const index = e.currentTarget.dataset.index;
                    downloadImage(url, `thumbnail_${index + 1}.png`);
                });
            });
        }
        
        // --- Image Generation Logic ---
        function switchImageGenTab(tabId) {
            const textTab = document.getElementById('tab-text-to-image');
            const imageTab = document.getElementById('tab-image-to-image');
            const textPanel = document.getElementById('panel-text-to-image');
            const imagePanel = document.getElementById('panel-image-to-image');

            if (tabId === 'text-to-image') {
                textTab.classList.add('border-accent-primary', 'text-accent-primary');
                textTab.classList.remove('border-transparent', 'text-text-secondary');
                imageTab.classList.add('border-transparent', 'text-text-secondary');
                imageTab.classList.remove('border-accent-primary', 'text-accent-primary');
                textPanel.classList.remove('hidden');
                imagePanel.classList.add('hidden');
            } else {
                imageTab.classList.add('border-accent-primary', 'text-accent-primary');
                imageTab.classList.remove('border-transparent', 'text-text-secondary');
                textTab.classList.add('border-transparent', 'text-text-secondary');
                textTab.classList.remove('border-accent-primary', 'text-accent-primary');
                imagePanel.classList.remove('hidden');
                textPanel.classList.add('hidden');
            }
        }
        
        async function generateImageIdea() {
            const topic = document.getElementById('gen-idea-topic').value.trim();
            const style = document.getElementById('gen-idea-style').value;
            if (!topic) {
                showPopup("Please enter a topic for the idea.", 'error');
                return;
            }
            const prompt = `Create a short, highly detailed, and creative prompt for an AI image generator. The topic is "${topic}" and the desired style is "${style}".`;
            const ideaPrompt = await callOpenAITextApi(prompt);
            if (ideaPrompt) {
                document.getElementById('gen-prompt-input').value = ideaPrompt;
            }
        }
        
        function handleGenImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                const preview = document.getElementById('gen-image-preview');
                preview.src = e.target.result;
                preview.classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }

        async function handleImageGeneration() {
            const button = document.getElementById('generate-image-btn');
            toggleButtonLoading(button, true);

            const resultsWrapper = document.getElementById('image-gen-results-wrapper');
            const outputDiv = document.getElementById('image-gen-output');
            resultsWrapper.classList.remove('hidden');
            outputDiv.innerHTML = `<div class="col-span-1 md:col-span-2 lg:col-span-3 flex justify-center items-center p-8"><div class="w-8 h-8 border-4 border-accent-primary border-t-transparent rounded-full animate-spin"></div><p class="ml-4">Generating your images...</p></div>`;

            const isTextMode = !document.getElementById('panel-text-to-image').classList.contains('hidden');
            const count = parseInt(document.getElementById('gen-count-input').value, 10);
            
            let generatedImages = [];

            if (isTextMode) {
                const prompt = document.getElementById('gen-prompt-input').value.trim();
                if (!prompt) {
                    showPopup("Please enter a prompt.", 'error');
                    toggleButtonLoading(button, false);
                    return;
                }
                for(let i = 0; i < count; i++){
                    const imageUrl = await callOpenAIImageApi(prompt);
                    if(imageUrl) generatedImages.push(imageUrl);
                }
            } else { // Image-to-Image mode
                const fileInput = document.getElementById('gen-image-upload');
                const file = fileInput.files[0];
                if (!file) {
                    showPopup("Please upload an image for inspiration.", 'error');
                    toggleButtonLoading(button, false);
                    return;
                }
                 const base64Image = await fileToBase64(file);
                const generatedPrompt = await callOpenAIVisionApi(base64Image);
                 if(generatedPrompt){
                    for(let i = 0; i < count; i++){
                        const imageUrl = await callOpenAIImageApi(generatedPrompt);
                        if(imageUrl) generatedImages.push(imageUrl);
                    }
                }
            }
            
            displayGeneratedImages(generatedImages, 'image-gen-output');
            toggleButtonLoading(button, false);
        }

        function displayGeneratedImages(images, outputElementId) {
            const outputDiv = document.getElementById(outputElementId);
            outputDiv.innerHTML = '';
            if (!images || images.length === 0) {
                outputDiv.innerHTML = `<p class="col-span-full text-center text-text-secondary">Generation failed. Please try again.</p>`;
                return;
            }

            images.forEach((imageUrl, index) => {
                const card = document.createElement('div');
                card.className = 'result-card p-4 text-center fade-in';
                card.innerHTML = `
                    <img src="${imageUrl}" class="w-full rounded-lg mx-auto mb-4" alt="Generated Image ${index + 1}">
                    <button class="main-btn py-2 px-5 inline-flex items-center" onclick="downloadImage('${imageUrl}', 'generated_image_${index + 1}.png')">
                        <i class="fas fa-download mr-2"></i>Download
                    </button>
                `;
                outputDiv.appendChild(card);
            });
        }


        // --- Image Background Remover Logic ---
        async function handleBgRemoval(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (!REMOVE_BG_API_KEY || REMOVE_BG_API_KEY === "YOUR_REMOVE.BG_API_KEY") {
                showPopup("remove.bg API Key is not configured. Please add the key in the script.", 'error');
                return;
            }

            const resultsWrapper = document.getElementById('bg-remover-results-wrapper');
            const originalPreview = document.getElementById('original-bg-image-preview');
            const removedPreview = document.getElementById('removed-bg-image-preview');
            const loader = document.getElementById('bg-remover-loader');
            const downloadBtn = document.getElementById('download-removed-bg-btn');

            const reader = new FileReader();
            reader.onload = (e) => {
                originalPreview.src = e.target.result;
            };
            reader.readAsDataURL(file);

            resultsWrapper.classList.remove('hidden');
            loader.classList.remove('hidden');
            downloadBtn.disabled = true;
            removedPreview.src = 'https://placehold.co/600x400/1A1A1A/A3A3A3?text=Processing...';

            const formData = new FormData();
            formData.append('image_file', file);
            formData.append('size', 'auto');

            try {
                const response = await fetch('https://api.remove.bg/v1.0/removebg', {
                    method: 'POST',
                    headers: {
                        'X-Api-Key': REMOVE_BG_API_KEY,
                    },
                    body: formData,
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    const errorMessage = errorData.errors?.[0]?.title || "An unknown error occurred.";
                    showPopup(`API Error: ${errorMessage}`, 'error');
                    loader.classList.add('hidden');
                    return;
                }

                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                
                removedPreview.src = url;
                generatedData.removedBgImageUrl = url;
                generatedData.removedBgImageFileName = `bg_removed_${file.name}`;
                downloadBtn.disabled = false;

            } catch (error) {
                showPopup("Failed to process the image. Check your network or API key.", 'error');
            } finally {
                loader.classList.add('hidden');
            }
        }

        function downloadRemovedBgImage() {
            if (!generatedData.removedBgImageUrl) return;
            const a = document.createElement('a');
            a.href = generatedData.removedBgImageUrl;
            a.download = generatedData.removedBgImageFileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // --- Image Compressor Logic ---
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('original-image-preview').src = e.target.result;
                document.getElementById('original-image-size').textContent = `Size: ${formatBytes(file.size)}`;
                document.getElementById('image-quality-section').classList.remove('hidden');
                document.getElementById('image-compressor-results-wrapper').classList.remove('hidden');
                // Trigger compression immediately on upload
                handleImageCompression();
            };
            reader.readAsDataURL(file);
        }

        function handleImageCompression() {
            const fileInput = document.getElementById('image-upload-input');
            const file = fileInput.files[0];
            if (!file) {
                 showPopup("Please upload an image first.", 'info');
                 return;
            }

            const quality = parseFloat(document.getElementById('image-quality-slider').value);
            document.getElementById('image-quality-value').textContent = quality;

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);

                    const mimeType = file.type === 'image/png' ? 'image/png' : 'image/jpeg';
                    const compressedDataUrl = canvas.toDataURL(mimeType, quality);
                    
                    document.getElementById('compressed-image-preview').src = compressedDataUrl;
                    
                    const compressedBlob = dataURLtoBlob(compressedDataUrl);
                    const originalSize = file.size;
                    const compressedSize = compressedBlob.size;
                    const reduction = Math.round(((originalSize - compressedSize) / originalSize) * 100);

                    document.getElementById('compressed-image-size').textContent = `Size: ${formatBytes(compressedSize)} (${reduction}% smaller)`;

                    generatedData.compressedImageDataUrl = compressedDataUrl;
                    generatedData.compressedImageFileName = `compressed_${file.name}`;
                    document.getElementById('download-compressed-btn').disabled = false;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function downloadCompressedImage() {
            if (!generatedData.compressedImageDataUrl) return;
            const a = document.createElement('a');
            a.href = generatedData.compressedImageDataUrl;
            a.download = generatedData.compressedImageFileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }


        // --- Content Generation Logic ---
        async function handleContentGeneration() {
            const keyword = document.getElementById('content-keyword-input').value.trim();
            if (!keyword) { showPopup("Please enter a topic first.", 'error'); return; }
            const button = document.getElementById('generate-content-btn');
            toggleButtonLoading(button, true);
            document.getElementById('content-results-wrapper').classList.add('hidden');
            const titlesPrompt = `Generate 5 catchy, SEO-optimized YouTube video titles for 2025-2026 on the topic: "${keyword}". Separate each title with "|||". Do not use numbering.`;
            const titlesResponse = await callOpenAITextApi(titlesPrompt);
            if (!titlesResponse) { toggleButtonLoading(button, false); return; }
            const titles = titlesResponse.split('|||').map(t => t.trim()).filter(Boolean);
            displayTitles(titles);
            generatedData.title = titles[0] || keyword;
            const descPrompt = `Generate a long, SEO-friendly YouTube description for a 2025 video titled: "${generatedData.title}". Include a hook, summary, placeholder timestamps, placeholder links, and a call-to-action. Use emojis.`;
            const tagsPrompt = `Generate up to 50 relevant, SEO-optimized YouTube tags for a video titled "${generatedData.title}". Include long-tail and short-tail keywords. The tags should be comma-separated.`;
            const copyrightPrompt = `Generate a standard "fair use" copyright disclaimer for a YouTube video for use in 2025.`;
            const [descResponse, tagsResponse, copyrightResponse] = await Promise.all([callOpenAITextApi(descPrompt), callOpenAITextApi(tagsPrompt), callOpenAITextApi(copyrightPrompt)]);
            if (descResponse) { generatedData.description = descResponse; document.getElementById('description-output').innerText = descResponse; }
            if (tagsResponse) { generatedData.tags = tagsResponse; document.getElementById('tags-output').innerText = tagsResponse; }
            if (copyrightResponse) { generatedData.copyright = copyrightResponse; document.getElementById('copyright-output').innerText = copyrightResponse; }
            document.getElementById('content-results-wrapper').classList.remove('hidden');
            toggleButtonLoading(button, false);
        }

        function displayTitles(titles) {
            const titlesOutput = document.getElementById('titles-output');
            titlesOutput.innerHTML = '';
            titles.forEach(title => {
                const titleEl = document.createElement('div');
                titleEl.className = 'flex justify-between items-center bg-bg-primary p-3 rounded-lg';
                titleEl.innerHTML = `<span class="flex-grow mr-4">${title}</span><button class="copy-btn text-text-secondary hover:text-accent-primary flex-shrink-0" title="Copy Title"><i class="fas fa-copy"></i></button>`;
                titleEl.querySelector('.copy-btn').addEventListener('click', () => copyToClipboard(title));
                titlesOutput.appendChild(titleEl);
            });
        }

        // --- Script Generation Logic ---
        async function handleIdeaGeneration() {
            const category = document.getElementById('idea-category-select').value;
            const keyword = document.getElementById('idea-keyword-input').value.trim();
            if (!keyword) { showPopup("Please enter a keyword for your idea.", 'error'); return; }
            const button = document.getElementById('generate-ideas-btn');
            toggleButtonLoading(button, true);
            document.getElementById('ideas-output').innerHTML = '';
            const prompt = `Based on the category "${category}" and the keyword "${keyword}", generate 5 unique and engaging YouTube video ideas. The ideas should be concise and serve as potential video titles. Separate each idea with "|||".`;
            const response = await callOpenAITextApi(prompt);
            if (response) {
                const ideas = response.split('|||').map(i => i.trim()).filter(Boolean);
                displayIdeas(ideas);
            }
            toggleButtonLoading(button, false);
        }

        function displayIdeas(ideas) {
            const ideasOutput = document.getElementById('ideas-output');
            const scriptTopicInput = document.getElementById('script-topic-input');
            const ideaHelperUI = document.getElementById('idea-helper-ui');
            ideasOutput.innerHTML = '';
            ideas.forEach(ideaText => {
                const ideaBtn = document.createElement('button');
                ideaBtn.className = 'w-full text-left p-3 bg-bg-tertiary rounded-lg hover:bg-accent-primary hover:text-bg-primary transition-colors';
                ideaBtn.textContent = ideaText;
                ideaBtn.addEventListener('click', () => {
                    scriptTopicInput.value = ideaText;
                    scriptTopicInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    ideaHelperUI.classList.add('hidden');
                });
                ideasOutput.appendChild(ideaBtn);
            });
        }

        async function handleScriptGeneration() {
            const topic = document.getElementById('script-topic-input').value.trim();
            const language = document.getElementById('script-language-select').value;
            const type = document.getElementById('script-type-select').value;
            const tone = document.getElementById('script-tone-select').value;
            const words = document.getElementById('script-words-input').value.trim();
            if (!topic || !words) { showPopup("Please fill all fields.", 'error'); return; }
            const button = document.getElementById('generate-script-btn');
            toggleButtonLoading(button, true);
            document.getElementById('script-results-wrapper').classList.add('hidden');
            const prompt = `You are an expert YouTube scriptwriter. Your task is to generate a complete video script based on the following specifications. **Topic**: "${topic}", **Language**: **${language}**, **Script Type**: **${type}**, **Tone**: **${tone}**, **Word Count**: Approximately **${words}** words. **Crucial Requirement**: The script MUST begin with a powerful, engaging hook within the first 15-30 seconds designed to grab the viewer's attention immediately. **Structural Guidance for Script Type "${type}":** - If "Training/Tutorial" or "How-To Guide", structure with clear, step-by-step instructions. - If "Explainer Video" or "Tech Explainer", break down the complex topic into simple, digestible sections. Start with the problem, then present the solution/explanation. - If "Listicle", format the main content as a numbered list (e.g., "Number 5:", "Number 4:", etc.). - If "Product Demo" or "Review", structure around key features, pros, and cons, and a final verdict. - If "Vlog", write in a personal, conversational, first-person style. - If "Interview", format as a Q&A between an "Interviewer" and "Guest". - For all other types, use a standard intro-body-conclusion format suitable for the selected tone. **Formatting (Strict):** Use timestamps for different sections (e.g., 00:00 - 00:15). Include placeholders for visuals or actions in parentheses, like (Show B-roll of a circuit board). Generate the script now.`;
            const scriptResponse = await callOpenAITextApi(prompt);
            if (scriptResponse) {
                generatedData.script = scriptResponse;
                document.getElementById('script-output').innerText = scriptResponse;
                document.getElementById('script-results-wrapper').classList.remove('hidden');
            }
            toggleButtonLoading(button, false);
        }

        // --- Prompt Generation Logic ---
        const promptStyles = {
            'text-to-image': {'Random': '...', 'Professional': '...', 'Mixed-Media Portrait': `...`,'3D Cartoon Horror-Comedy': `...`},
            'text-to-video': {'Animated Sci-Fi Horror Story': `...`,'100 Faceless 2D Animation Ideas': `...`},
            'general-ai': {'Zero-Shot': '...','One-Shot': '...','Few-Shot': '...','Chain of Thought': '...','Role-Playing': '...','Text Summarization': '...'}
        };

        function updatePromptStyles() {
            const promptCategorySelect = document.getElementById('prompt-category-select');
            const promptStyleSelect = document.getElementById('prompt-style-select');
            const category = promptCategorySelect.value;
            promptStyleSelect.innerHTML = '';
            promptStyleSelect.disabled = true;
            if (category && promptStyles[category]) {
                promptStyleSelect.disabled = false;
                promptStyleSelect.innerHTML = '<option value="">-- Select a Style --</option>';
                for (const style in promptStyles[category]) {
                    const option = document.createElement('option');
                    option.value = style;
                    option.textContent = style;
                    promptStyleSelect.appendChild(option);
                }
            } else {
                promptStyleSelect.innerHTML = '<option>-- Select Category First --</option>';
            }
        }

        async function handlePromptGeneration() {
            const topic = document.getElementById('prompt-topic-input').value.trim();
            const category = document.getElementById('prompt-category-select').value;
            const style = document.getElementById('prompt-style-select').value;
            const quantity = document.getElementById('prompt-quantity-input').value;
            if (!topic || !category || !style) { showPopup("Please fill all fields.", 'error'); return; }
            const button = document.getElementById('generate-prompt-btn');
            toggleButtonLoading(button, true);
            const promptResultsWrapper = document.getElementById('prompt-results-wrapper');
            promptResultsWrapper.innerHTML = '';
            promptResultsWrapper.classList.add('hidden');
            const masterPrompt = `You are an expert prompt engineer. The user wants to generate ${quantity} prompt(s). Their topic is: "${topic}". The prompt style they need is: "${style}". Based on this style description: "${promptStyles[category][style]}" Generate ${quantity} unique, detailed, and ready-to-use prompt(s) that apply this style to the user's topic. IMPORTANT: Separate each distinct prompt with the delimiter "|||---|||". Do not include any other text or numbering outside of the prompts themselves.`;
            const response = await callOpenAITextApi(masterPrompt);
            if (response) {
                generatedData.prompts = response.split('|||---|||').map(p => p.trim()).filter(Boolean);
                displayPrompts(generatedData.prompts);
                promptResultsWrapper.classList.remove('hidden');
            }
            toggleButtonLoading(button, false);
        }
        
        async function handleInspirationPromptGeneration() {
             const idea = document.getElementById('insp-idea-input').value.trim();
            const style = document.getElementById('insp-style-select').value;
            const tone = document.getElementById('insp-tone-select').value;
            const length = document.getElementById('insp-length-select').value;

            if (!idea) {
                showPopup("Please enter your idea or title.", 'error');
                return;
            }

            const prompt = `Create a detailed, ready-to-use prompt for an AI image generator. The prompt should be about: "${idea}". The desired style is "${style}" with a "${tone}" tone. The prompt length should be "${length}".`;
            const response = await callOpenAITextApi(prompt);
            if (response) {
                document.getElementById('inspiration-prompt-output').innerText = response;
                document.getElementById('inspiration-prompt-output-wrapper').classList.remove('hidden');
                generatedData.inspirationPrompt = response;
            }
        }
        
        async function generateInspirationPrompt(type) {
            let prompt = '';
            if (type === 'upload') {
                const fileInput = document.getElementById('inspiration-upload-input');
                const file = fileInput.files[0];
                if (!file) {
                    showPopup('Please upload an image to get a prompt for it.', 'info');
                    return;
                }
                const base64Image = await fileToBase64(file);
                // This is a placeholder for a real vision API call
                prompt = `Analyze this image and create a detailed prompt for an AI image generator to create a similar high-quality thumbnail. Describe the style, colors, composition, subject, and mood.`;
                const visionResponse = await callOpenAIVisionApi(base64Image);
                 if (visionResponse) {
                    document.getElementById('inspiration-prompt-output').innerText = visionResponse;
                    document.getElementById('inspiration-prompt-output-wrapper').classList.remove('hidden');
                    generatedData.inspirationPrompt = visionResponse;
                }
                return;
            } 
            
            switch(type) {
                case 'tech':
                    prompt = "Generate a prompt for a futuristic, sleek tech review thumbnail, featuring a glowing product on a dark, abstract background with circuit board patterns. Use a modern, sans-serif font for the title.";
                    break;
                case 'vlog':
                    prompt = "Generate a prompt for a bright and airy travel vlog thumbnail. A person is looking out over a beautiful landscape, with a soft, warm color grade. Use a friendly, handwritten-style font for the location name.";
                    break;
                case 'gaming':
                    prompt = "Generate a prompt for an action-packed, dynamic gaming thumbnail. It should feature an intense character from the game, explosions in the background, and bold, impactful text for the video title.";
                    break;
                case 'tutorial':
                    prompt = "Generate a prompt for a clean and clear 'how-to' tutorial thumbnail. It should show a before-and-after comparison or a key step of the process, with simple graphics and easy-to-read text.";
                    break;
            }
            
            const response = await callOpenAITextApi(`Create a detailed, ready-to-use prompt for an AI image generator based on this idea: ${prompt}`);
            if (response) {
                document.getElementById('inspiration-prompt-output').innerText = response;
                document.getElementById('inspiration-prompt-output-wrapper').classList.remove('hidden');
                generatedData.inspirationPrompt = response;
            }
        }
        
        function handleInspirationUpload(event) {
            const file = event.target.files[0];
            if (file) {
                generateInspirationPrompt('upload');
            }
        }

        function displayPrompts(prompts) {
            const promptResultsWrapper = document.getElementById('prompt-results-wrapper');
            promptResultsWrapper.innerHTML = '';
            prompts.forEach((promptText, index) => {
                const promptCard = document.createElement('div');
                promptCard.className = 'result-card p-6 fade-in';
                promptCard.innerHTML = `<div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold text-text-primary">Prompt #${index + 1}</h3><button class="copy-btn text-text-secondary hover:text-accent-primary" title="Copy Prompt"><i class="fas fa-copy text-lg"></i></button></div><div class="text-text-secondary whitespace-pre-wrap bg-bg-primary p-4 rounded-lg">${promptText}</div>`;
                promptCard.querySelector('.copy-btn').addEventListener('click', () => copyToClipboard(promptText));
                promptResultsWrapper.appendChild(promptCard);
            });
        }

        // --- Channel Extractor Logic ---
        async function handleExtraction() {
            const url = document.getElementById('extractor-url-input').value.trim();
            if (!url) { showPopup("Please enter a YouTube URL.", 'error'); return; }
            const videoId = getYouTubeID(url);
            if (!videoId) { showPopup("Invalid YouTube URL.", 'error'); return; }
            const button = document.getElementById('extract-btn');
            toggleButtonLoading(button, true);
            document.getElementById('extractor-results-wrapper').classList.add('hidden');
            const thumbnailUrl = `https://i.ytimg.com/vi/${videoId}/maxresdefault.jpg`;
            document.getElementById('extractor-thumbnail-output').src = thumbnailUrl;
            document.getElementById('extractor-thumbnail-output').onerror = () => { document.getElementById('extractor-thumbnail-output').src = `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`; };
            let title = await getVideoTitle(videoId);
            if (!title) { toggleButtonLoading(button, false); return; }
            generatedData.extractorTitle = title;
            document.getElementById('extractor-title-output').innerText = title;
            const descPrompt = `Generate a long, SEO-friendly YouTube description for a video titled: "${title}". Include a hook, summary, placeholder timestamps, placeholder links, and a call-to-action. Use emojis.`;
            const tagsPrompt = `Generate up to 50 relevant, SEO-optimized YouTube tags for a video titled "${title}". Include long-tail and short-tail keywords. The tags should be comma-separated.`;
            const [descResponse, tagsResponse] = await Promise.all([callOpenAITextApi(descPrompt), callOpenAITextApi(tagsPrompt)]);
            if (descResponse) { generatedData.extractorDesc = descResponse; document.getElementById('extractor-desc-output').innerText = descResponse; }
            if (tagsResponse) { generatedData.extractorTags = tagsResponse; document.getElementById('extractor-tags-output').innerText = tagsResponse; }
            document.getElementById('extractor-results-wrapper').classList.remove('hidden');
            toggleButtonLoading(button, false);
        }

        // --- Tags Generator from URL Logic ---
        async function handleTagsFromUrlGeneration() {
            const url = document.getElementById('tags-url-input').value.trim();
            if (!url) { showPopup("Please enter a YouTube URL.", 'error'); return; }
            const videoId = getYouTubeID(url);
            if (!videoId) { showPopup("Invalid YouTube URL.", 'error'); return; }
            const button = document.getElementById('generate-tags-from-url-btn');
            toggleButtonLoading(button, true);
            document.getElementById('tags-generator-results-wrapper').classList.add('hidden');
            let title = await getVideoTitle(videoId);
            if (!title) { toggleButtonLoading(button, false); return; }
            const tagsPrompt = `Generate up to 50 relevant, SEO-optimized YouTube tags for a video titled "${title}". Include long-tail and short-tail keywords. The tags should be comma-separated.`;
            const tagsResponse = await callOpenAITextApi(tagsPrompt);
            if (tagsResponse) {
                generatedData.generatedTags = tagsResponse;
                document.getElementById('tags-generator-output').innerText = tagsResponse;
                document.getElementById('tags-generator-results-wrapper').classList.remove('hidden');
            }
            toggleButtonLoading(button, false);
        }

        // --- Keyword Suggester Logic ---
        async function handleKeywordSuggestion() {
            const topic = document.getElementById('keyword-suggester-input').value.trim();
            if (!topic) { showPopup("Please enter a topic.", 'error'); return; }
            const button = document.getElementById('generate-keywords-btn');
            toggleButtonLoading(button, true);
            document.getElementById('keyword-suggester-results-wrapper').classList.add('hidden');
            const prompt = `Generate a list of relevant SEO keywords and tags for a YouTube video about "${topic}". Include a mix of short-tail and long-tail keywords. The output should be a single, comma-separated list.`;
            const response = await callOpenAITextApi(prompt);
            if(response) {
                generatedData.suggestedKeywords = response;
                document.getElementById('keyword-suggester-output').innerText = response;
                document.getElementById('keyword-suggester-results-wrapper').classList.remove('hidden');
            }
            toggleButtonLoading(button, false);
        }

        // --- Thumbnail Downloader Logic ---
        function handleThumbnailDownload() {
            const url = document.getElementById('thumbnail-url-input').value.trim();
            if (!url) { showPopup("Please enter a YouTube URL.", 'error'); return; }
            const videoId = getYouTubeID(url);
            if (!videoId) { showPopup("Invalid YouTube URL.", 'error'); return; }
            const thumbnailUrl = `https://i.ytimg.com/vi/${videoId}/maxresdefault.jpg`;
            const outputImg = document.getElementById('thumbnail-downloader-output');
            outputImg.src = thumbnailUrl;
            outputImg.onerror = () => { outputImg.src = `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`; };
            document.getElementById('thumbnail-downloader-results-wrapper').classList.remove('hidden');
        }

        // --- Find Competitors Logic ---
        async function handleFindCompetitors() {
            const topic = document.getElementById('competitor-topic-input').value.trim();
            if (!topic) { showPopup("Please enter a channel name or topic.", 'error'); return; }
            const button = document.getElementById('find-competitors-btn');
            toggleButtonLoading(button, true);
            const competitorResultsWrapper = document.getElementById('competitor-results-wrapper');
            competitorResultsWrapper.innerHTML = '';
            competitorResultsWrapper.classList.remove('hidden');
            competitorResultsWrapper.innerHTML = `<div class="col-span-1 lg:col-span-3 flex justify-center items-center p-8"><div class="w-8 h-8 border-4 border-accent-primary border-t-transparent rounded-full animate-spin"></div></div>`;
            const prompt = `Act as a YouTube channel analyst. Based on the channel topic or name "${topic}", find 10 similar competitor channels. For each channel, provide: Channel Name, a clean version of the channel name for its handle (e.g., "@channelname"), Estimated Subscribers (e.g., "5.2M"), Estimated Total Videos (e.g., "~150"), and Estimated Total Views (e.g., "~10M"). Format the response strictly as follows, with each channel's data on a new line and separated by a pipe "|". Separate each channel block with "|||---|||". Example: Channel Name: Example Channel 1 | Handle: examplechannel1 | Subscribers: ~5.2M | Total Videos: ~150 | Total Views: ~10M`;
            const response = await callOpenAITextApi(prompt);
            if (response) {
                const competitors = response.split('|||---|||').map(c => c.trim()).filter(Boolean);
                displayCompetitors(competitors);
            } else {
                 competitorResultsWrapper.innerHTML = `<p class="col-span-1 lg:col-span-3 text-center text-text-secondary">Could not find competitors. Please try a different topic.</p>`;
            }
            toggleButtonLoading(button, false);
        }

        function displayCompetitors(competitors) {
            const competitorResultsWrapper = document.getElementById('competitor-results-wrapper');
            competitorResultsWrapper.innerHTML = '';
            competitors.forEach(competitorText => {
                const competitorData = {};
                competitorText.split('|').forEach(part => {
                    const [key, ...value] = part.split(':');
                    if (key && value) competitorData[key.trim()] = value.join(':').trim();
                });
                const channelName = competitorData['Channel Name'] || 'N/A';
                const handle = (competitorData['Handle'] || channelName.replace(/\s+/g, '')).replace('@', '');
                const channelUrl = `https://www.youtube.com/@${handle}`;
                const profilePicUrl = `https://unavatar.io/youtube/${handle}`;
                const card = document.createElement('div');
                card.className = 'result-card p-4 fade-in flex flex-col';
                card.innerHTML = `
                    <a href="${channelUrl}" target="_blank" class="block mb-4">
                        <img src="${profilePicUrl}" onerror="this.onerror=null;this.src='https://placehold.co/300x150/1A1A1A/00FFA3?text=${handle.substring(0,2).toUpperCase()}';" alt="${channelName}" class="w-full rounded-lg aspect-video object-cover">
                    </a>
                    <h4 class="text-md font-bold text-accent-primary truncate">${channelName}</h4>
                    <div class="mt-2 text-xs space-y-1 text-text-secondary flex-grow">
                        <p><i class="fas fa-users fa-fw mr-2"></i>${competitorData['Subscribers'] || 'N/A'}</p>
                        <p><i class="fas fa-video fa-fw mr-2"></i>${competitorData['Total Videos'] || 'N/A'}</p>
                        <p><i class="fas fa-eye fa-fw mr-2"></i>${competitorData['Total Views'] || 'N/A'}</p>
                    </div>`;
                competitorResultsWrapper.appendChild(card);
            });
        }

        // --- Other Tools Logic ---
        function handleSubscribeLink() {
            const urlInput = document.getElementById('subscribe-url-input');
            let url = urlInput.value.trim();
            if (!url) { showPopup("Please enter a channel URL.", 'error'); return; }
            if (url.includes('?')) {
                url = url.substring(0, url.indexOf('?'));
            }
            const subscribeUrl = `${url}?sub_confirmation=1`;
            generatedData.subscribeLink = subscribeUrl;
            document.getElementById('subscribe-link-output').innerText = subscribeUrl;
            document.getElementById('subscribe-link-results-wrapper').classList.remove('hidden');
        }

        function handleMoneyCalculation() {
            const views = parseFloat(document.getElementById('calculator-views-input').value) || 0;
            const rpm = parseFloat(document.getElementById('calculator-rpm-input').value) || 0;
            const daily = (views / 1000) * rpm;
            const monthly = daily * 30;
            const yearly = daily * 365;
            document.getElementById('calculator-daily-output').innerText = `$${daily.toFixed(2)}`;
            document.getElementById('calculator-monthly-output').innerText = `$${monthly.toFixed(2)}`;
            document.getElementById('calculator-yearly-output').innerText = `$${yearly.toFixed(2)}`;
            document.getElementById('calculator-results-wrapper').classList.remove('hidden');
        }

        function handleCapitalization() {
            const input = document.getElementById('capitalize-input').value.trim();
            if (!input) { showPopup("Please enter a title.", 'error'); return; }
            generatedData.capitalizedTitle = toTitleCase(input);
            document.getElementById('capitalize-output').innerText = generatedData.capitalizedTitle;
            document.getElementById('capitalize-results-wrapper').classList.remove('hidden');
        }

        function handleEmbedCodeGeneration() {
            const url = document.getElementById('embed-url-input').value.trim();
            const width = document.getElementById('embed-width-input').value;
            const height = document.getElementById('embed-height-input').value;
            if (!url) { showPopup("Please enter a video URL.", 'error'); return; }
            const videoId = getYouTubeID(url);
            if (!videoId) { showPopup("Invalid YouTube URL.", 'error'); return; }
            const embedCode = `<iframe width="${width}" height="${height}" src="https://www.youtube.com/embed/${videoId}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
            generatedData.embedCode = embedCode;
            document.getElementById('embed-output').value = embedCode;
            document.getElementById('embed-results-wrapper').classList.remove('hidden');
        }

        // --- Typewriter Effect ---
        function startTypewriter() {
            const animatedText = document.getElementById('animated-text');
            if (!animatedText) return;

            const phrases = ["A Free Marketplace for AI Tools", "Powered by Team Mustafa Talks", "Powered by The Talks Automation"];
            let phraseIndex = 0;
            let charIndex = 0;
            let isDeleting = false;

            function type() {
                const currentPhrase = phrases[phraseIndex];
                if (isDeleting) {
                    animatedText.textContent = currentPhrase.substring(0, charIndex - 1);
                    charIndex--;
                } else {
                    animatedText.textContent = currentPhrase.substring(0, charIndex + 1);
                    charIndex++;
                }

                let typeSpeed = isDeleting ? 50 : 150;

                if (!isDeleting && charIndex === currentPhrase.length) {
                    typeSpeed = 2000; // Pause at end
                    isDeleting = true;
                } else if (isDeleting && charIndex === 0) {
                    isDeleting = false;
                    phraseIndex = (phraseIndex + 1) % phrases.length;
                    typeSpeed = 500; // Pause before new phrase
                }

                setTimeout(type, typeSpeed);
            }
            type();
        }


        // --- Utility Functions ---
        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }

        function dataURLtoBlob(dataurl) {
            var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
                bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
            while(n--){
                u8arr[n] = bstr.charCodeAt(n);
            }
            return new Blob([u8arr], {type:mime});
        }
        
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result.split(',')[1]);
                reader.onerror = error => reject(error);
            });
        }

        async function getVideoTitle(videoId) {
            try {
                const oembedUrl = `https://noembed.com/embed?url=https://www.youtube.com/watch?v=${videoId}`;
                const response = await fetch(oembedUrl);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                if (data.title) {
                    return data.title;
                } else if (data.error) {
                    throw new Error(data.error);
                }
                throw new Error("Title not found in response");
            } catch (error) {
                console.error("Failed to fetch title:", error);
                showPopup("Could not fetch video title. The video might be private or deleted.", "error");
                return null;
            }
        }

        function getYouTubeID(url) {
            let ID = '';
            url = url.replace(/(>|<)/gi, '').split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/);
            if (url[2] !== undefined) {
                ID = url[2].split(/[^0-9a-z_\-]/i);
                ID = ID[0];
            } else {
                ID = url;
            }
            return ID;
        }

        async function downloadImage(imageSrc, fileName) {
            try {
                const link = document.createElement('a');
                link.href = imageSrc;
                link.download = fileName;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                console.error("Download failed:", error);
                showPopup("Failed to download image.", "error");
            }
        }

        function copyToClipboard(text) {
            if (!text) return;
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-9999px';
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showPopup("Copied to clipboard!", 'success');
            } catch (err) {
                showPopup("Failed to copy.", 'error');
            }
            document.body.removeChild(textArea);
        }

        function toTitleCase(str) {
            const smallWords = /^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;
            return str.split(' ').map((word, index, arr) => {
                if (index === 0 || index === arr.length - 1 || !smallWords.test(word)) {
                    return word.charAt(0).toUpperCase() + word.substr(1).toLowerCase();
                }
                return word.toLowerCase();
            }).join(' ');
        }

        function showPopup(message, type = 'success') {
            clearTimeout(popupTimeout);
            const popup = document.getElementById('popup');
            const popupText = document.getElementById('popup-text');
            popupText.innerText = message;
            popup.className = 'fixed bottom-5 right-5 text-white p-4 rounded-xl shadow-2xl z-50 transition-all duration-300 transform';
            const typeClasses = { success: 'bg-green-600', error: 'bg-red-600', info: 'bg-blue-600' };
            popup.classList.add(typeClasses[type] || 'bg-green-600');
            popup.classList.remove('translate-y-20', 'opacity-0');
            popup.classList.add('translate-y-0', 'opacity-100');
            popupTimeout = setTimeout(() => {
                popup.classList.remove('translate-y-0', 'opacity-100');
                popup.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }
    </script>
</body>
</html>
